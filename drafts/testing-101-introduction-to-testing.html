<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Summarize post" />
    <meta name="author" content="Aly Sivji" />
    <meta name="generator" content="Pelican (VoidyBootstrap theme)" />
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Testing 101: Introduction to Testing"/>
    <meta property="og:url" content="../drafts/testing-101-introduction-to-testing.html"/>
      <meta property="og:description" content="Summarize post"/>
      <meta property="article:section" content="Deep Dives"/>
        <meta property="article:tag" content="art-of-developer-testing"/>
        <meta property="article:tag" content="testing"/>
        <meta property="article:tag" content="python"/>
      <meta property="og:image"
            content="https://alysivji.github.io/images/20-29/29_header.png"/>
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Testing 101: Introduction to Testing">
    <meta name="twitter:description" content="Summarize post">
    <meta name="twitter:site" content="@CaiusSivjus">
    <meta name="twitter:creator" content="@CaiusSivjus">
    <meta name="twitter:domain" content="..">
      <meta property="twitter:image"
            content="https://alysivji.github.io/images/20-29/29_header.png"/>

    <title>Testing 101: Introduction to Testing - Siv Scripts</title>

        <link rel="stylesheet"
              href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
              integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
              crossorigin="anonymous" />
      <link rel="stylesheet"
            href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
            integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
            crossorigin="anonymous">


      <link rel="stylesheet" href="../theme/css/tango.css" />
      <link rel="stylesheet" href="../theme/css/voidybootstrap.css" />
      <link rel="stylesheet" href="../theme/css/dataframe.css" />
      <link rel="stylesheet" href="../theme/css/custom.css" />

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js" integrity="sha384-FFgGfda92tXC8nCNOxrCQ3R8x1TNkMFqDZVQdDaaJiiVbjkPBXIJBx0o7ETjy8Bh" crossorigin="anonymous"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js" integrity="sha384-ZoaMbDF+4LeFxg6WdScQ9nnR1QC2MIRxA1O9KWEXQwns1G8UNyIEZIQidzb0T1fo" crossorigin="anonymous"></script>
    <![endif]-->

    <link rel="shortcut icon" href="../files/favicon.ico" />
        <link href="http://alysivji.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Siv Scripts Atom Feed" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-90986575-1', '');
  ga('send', 'pageview');

</script>
  </head>

  <body>
    <nav class="navbar navbar-default">
      <div class="container">
	   <div class="navbar-header">
		<button type="button" class="navbar-toggle"
				data-toggle="collapse" data-target="#main-navbar-collapse">
		  <span class="sr-only">Toggle navigation</span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		</button>
		<a class="navbar-brand" href="../" rel="home">
          <i class="fa fa-home fa-fw fa-lg"> </i> </a>
       </div>

      <div class="collapse navbar-collapse" id="main-navbar-collapse">
        <ul class="nav navbar-nav">
              <li>
                <a href="../pages/about.html">About</a>
              </li>
              <li>
                <a href="../pages/talks.html">Talks</a>
              </li>
            <li class="divider"></li>
            <li class="">
              <a href="../archives.html">Archives</a>
            </li>
          <li class="divider"></li>
            <li><a href="http://alysivji.github.io/feeds/all.atom.xml"
                   type="application/atom+xml" rel="alternate">
                <i class="fa fa-rss fa-fw fa-lg"></i> </a></li>
        </ul> <!-- /nav -->
      </div> <!-- /navbar-collapse -->
	  </div> <!-- /container -->
    </nav> <!-- /navbar -->

	<div class="jumbotron" id="overview">
	  <div class="container">
		<h1><a href="../">Siv Scripts</a></h1>
		<p class="lead">Solving Problems Using Code</p>
	  </div>
	</div>

    <div class="container" id="main-container">
      <div class="row">
        <div class="col-md-9" id="content">
<article itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
  <header class="article-header">
<abbr class="article-header-date">
  Sun 24 June 2018
</abbr> <h1>
  <a href="../drafts/testing-101-introduction-to-testing.html" rel="bookmark"
     title="Permalink to Testing 101: Introduction to Testing">
    Testing 101: Introduction to Testing
  </a>
</h1><div class="article-header-info">
  <p>
      Posted by <a href="../author/aly-sivji.html">Aly Sivji</a>
    in 
    <a href="../category/deep-dives.html">
      Deep Dives</a>
    &nbsp;&nbsp;
  </p>
</div> <!-- /.article-header-info -->  </header>
  <div class="content-body" itemprop="text articleBody">
	<p>[TODO make picture... of what?</p>
<p>professor teaching</p>
<p>blackboard with testing 101]</p>
<p>Programming is writing code to solve problems. Software Engineering is the practice of using a <strong>structured process</strong> to solve problems. As engineers, we want to have a codebase we can change, extend, and refactor as required. Tests provide assurances that program functionality does not <a href="https://en.wikipedia.org/wiki/Regression_testing">regress</a>.</p>
<p>Over the past year, I've spent a lot of time thinking about testing strategies and best practices that can help ensure correctness and allow for future modification. Specifically thought about <em>what</em> to test, <em>how</em> to test, and <em>when</em> to test. Books, blogs, podcasts, YouTube videos, lectures, discussions with friends and colleagues. Wanted to find the best way forward as I had an awesome opportunity at work.</p>
<p>At my last job, I worked with a Senior Engineer to build out a microservices-based backend to replace our existing Django monolith. It was a greenfield project and we were encouraged to try new things. Our Director of Engineering gave us a full month to plan out the project before letting us write a single line of production code. This time was instrumental in project success as we had time to try a few ideas before finalizing our system design. I learned a lot by pulling threads and asking questions. At every architecture meeting, I was the one thinking about how we were going to test the system we were designing.</p>
<p>I soon realized there was no holy grail of testing. Like everything else in programming, it's about <a href="https://en.wikipedia.org/wiki/The_Pragmatic_Programmer">being pragmatic</a>. Pragmatic in <em>what</em> we test, <em>how</em> we test, and <em>when</em> we test. We should use tools that increase productivity and make the process so effortless that writing tests became the default way of doing things.</p>
<p>If testing feels like a chore, programmers won't do it. This is how software quality slips. We dread going into the codebase because either there are no tests or the tests that exist are so brittle that we're forced to rewrite unit tests as we refactor code. This is not what Software Engineering is about. Tests should not hamper our ability to make changes to the codebase. We should be spending time writing business logic, not wrestling with tests.</p>
<p>[picture of pendulum - not writing tests.... poor testing strategy with brittle tests]
[spectrum?]</p>
<p>We need to start thinking about our testing strategy as we are architecting the system. In my opinion, this is one aspect the <a href="https://en.wikipedia.org/wiki/Test-driven_development">TDD folks</a> have done right. Thinking about tests improves how the system design as we are <a href="https://en.wikipedia.org/wiki/Eating_your_own_dog_food">dogfooding</a> our APIs and thinking through implementations as we write code that is easy to test.</p>
<p>This is the first in a series of posts where I am going to walk through my thoughts on testing. I'll start with the basics and then go through tools and techniques I use to write testable code.</p>
<p>Disclaimer: My thoughts on testing are evolving as I gain more experience and exposure. I have <a href="https://blog.codinghorror.com/strong-opinions-weakly-held/">strong opinions that are weakly held</a>.</p>
<hr>
<h4>Table of Contents</h4>
<!-- TOC -->

<ul>
<li><a href="#what-is-testing">What is Testing</a></li>
<li><a href="#benefits-of-testing">Benefits of Testing</a></li>
<li><a href="#black-box-vs-white-box">Black Box vs White Box</a></li>
<li><a href="#test-pyramid">Test Pyramid</a></li>
<li><a href="#structuring-tests">Structuring Tests</a></li>
<li><a href="#what-to-test">What to Test</a></li>
<li><a href="#when-to-write-test">When to Write Test</a></li>
<li><a href="#testing-anti-patterns">Testing Anti-Patterns</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<!-- /TOC -->

<hr>
<h2>What is Testing</h2>
<p><a name="what-is-testing"></a></p>
<p>To understand what a test is, we need to start with a diagram and some definitions.</p>
<p class="aligncenter">
  <img src="/images/30-39/system_under_test.jpg" alt="Diagram of a system under test" />
</p>

<p>A <strong>System Under Test (SUT)</strong> is the entity that is currently being tested. This could be a line of code, a method, or an entire program.</p>
<p><strong>Testing</strong> refers to the process of entering inputs into our system under test and validating outputs against our acceptance criteria. If output is okay, our test passes. If output is not okay, our test fails and we have to debug. Hopefully the test failure left enough breadcrumbs for us to find out where to look.</p>
<!-- TODO -->

<ul>
<li>test properties: deterministic</li>
</ul>
<hr>
<h2>Benefits of Testing</h2>
<p><a name="benefits-of-testing"></a></p>
<p>This was hinted at in the introduction, but it's best to be explicit. When we write code, we need to run it to ensure that it is doing what we expect it to. Tests are a contract we write with our code: given a value, we expect a certain result to be returned.</p>
<p>Test provides a feedback mechanism that informs us if our program is working as intended. If we change the code and tests pass, we know our program works the way our test expects. If tests fail, we need to understand why they failed so we can make modify our code, as required.</p>
<p class="aligncenter">
  <img src="/images/30-39/feedback_loop.jpg" width=400 alt="Tests provide a feedback mechanism" />
</p>

<p>We can run our code for testing purposes many different ways. The simplest way is manually where we try run a command in the REPL or refresh a webpage to make sure that our program does what it is supposed to. While this type of testing is fine for small projects, it becomes unmanageable for any project with modicum of complexity.</p>
<p>Any program that does anything of interest requires interaction amongst functions, classes, and modules. This creates dependency between components and could result in a situation where changing one line of code breaks functionality somewhere unexpected.</p>
<p>This means we have to test our entire application every time we modify our code. Doing this manually is not very scalable, so we automate the process by codifying our testing logic so it can be run on-demand.</p>
<!-- ADD MORE HERE -->

<p>from slides:
<em> validate the program works as expected
</em> makes the code base malleable as we can confirm that changes we make do not break existing functionality
* identify bugs earlier in the SDLC
  * http://blog.celerity.com/the-true-cost-of-a-software-bug
- tests show that developer has actually thought about the problem
  - they used their own API</p>
<p>Tests also force developers to write better code
    We have to balance getting things done with writing code we can test
    Sometimes it’s faster to use shortcuts that increase code coupling between modules and lead to complex interdependencies (i.e. add additional relationships to models)
    Knowing we have to test our changes led to developing a more modular code base
    Tests made code less crazy. We can codify conditions that define our system to be of working state and ensure that all code changes do not affect functionality.
    When we write tests, it take a step back and consider how our code can break. This is good.</p>
<hr>
<h2>Black Box vs White Box</h2>
<p><a name="black-box-vs-white-box"></a></p>
<p>Tests can be broadly classified into two broad categories: black box testing and white box testing.</p>
<p><strong>Black Box Testing</strong> refers to testing techniques in which the tester cannot see the inner workings of the item being tested.</p>
<p class="aligncenter">
  <img src="/images/30-39/black_box_testing.jpg" width=400 alt="Picture showing input and output going into a blackbox" />
</p>

<p><strong>White Box Testing</strong> is the technique in which the tester can see the inner workings of the item being tested.</p>
<p class="aligncenter">
  <img src="/images/30-39/white_box_testing.jpg" width=400 alt="Picture showing input and output going into a transparent box where we can see how information flows" />
</p>

<p>As developers, we perform white box testing. We wrote the code inside of the box so we can test it more thoroughly. This is not to say that there is no need for black box testing, we should still have somebody check things at a higher level as proximity to the code could result in blind spots.</p>
<hr>
<h2>Test Pyramid</h2>
<p><a name="test-pyramid"></a></p>
<p>The Automated Test Pyramid provides guidance on how to structure our testing strategy. It says we should write a lot of low-level unit tests (cheap, fast) vs a small amount of high-level functional tests (expensive, slow).</p>
<p class="aligncenter">
  <img src="/images/30-39/test_pyramid.png" width=550 alt="Picture showing automated testing pyramid" />
</p>

<p>The Pyramid is not a hard and fast rule, but it provides a good place to start. Write as many tests at each level that allow you to have comfort with the functionality of your system. While it's a good idea to have a general testing strategy in mind, it's best to iterate towards something that works for your project. Nobody starts off with an optimal testing strategy; our code base is always a work in progress.</p>
<h3>Unit Tests</h3>
<p>Unit tests are low-level tests that focus on testing of a specific part of a system. These tests are written by developers during the Implementation Phase of the <a href="https://en.wikipedia.org/wiki/Systems_development_life_cycle">Software Development Life Cycle</a> (SDLC), i.e. white box tests.</p>
<p>How big is a unit? It all depends on what is being tested. Unit tests are cheap to write and fast to run. Test failures should provide enough contextual information to pinpoint the source of the error.</p>
<p>Unit tests should be independent and isolated. Tests which interact with external components decreases test speed and increases test scope. We should replace external dependencies, outside the SUT, with mocks via <a href="https://en.wikipedia.org/wiki/Monkey_patch">monkey patching</a> or <a href="https://en.wikipedia.org/wiki/Dependency_injection">dependency injection</a> to make tests deterministic; this topic deserves a separate post.</p>
<p>The Test Pyramid recommends having a lot of unit tests in our test suite. These tests give us confidence that our program is working as expected. Writing new coding or modifying existing code might require us to rewrite some of our tests. This is standard practice, our test suite grows with our code base. We just need to be cognizant of the test suite growing in complexity. Code that tests our production code is also production code. Take the time to refactor your tests to ensure you are writing tests efficiently and effectively. Learning the intricacies of testing tools will make your testing effortless.</p>
<h4>Unit Test Example</h4>
<p>Suppose we have the following function that takes a list of words and returns the most common word and the number of occurrences of that word.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_top_word</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
    <span class="c1"># Return most common word &amp; occurrences</span>
    <span class="n">word_counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">word_counter</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>


<p>We can test this function by creating a list, running the <code>find_top_word</code> function over that list and comparing the results of the function to the value we expect:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_find_top_word</span><span class="p">():</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;bat&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">find_top_word</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;foo&quot;</span>
    <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>


<p>If we ever wanted to change the implementation of <code>find_top_words</code>, we can do it without fear. Our test ensures that the functionality of <code>find_top_word</code> cannot change without causing a failure.</p>
<h3>Integration Tests</h3>
<p>Every complex application has internal and external components working together to do something interesting. In contrast to units tests which focus on individual components, integration tests combine various parts of the system and test them together as a group. Integration testing can also refer to testing at service boundaries of our application, i.e. when it needs go out to the database, file system, or external API.</p>
<p>These tests are typically written by developers, but they don't have to be. By definition, integration tests are larger in scope and take longer to run than unit tests. This means that test failures require some investigation, we know that one of the components in our test is not working, but the failure's exact location cannot be known. This is in contrast to unit tests which are smaller in scope and indicate exactly where things have failed.</p>
<p>We should try to run integration tests in a production-like environment; this minimizes the chance that tests fail due to differences in server configuration.</p>
<h4>Integration Test Example</h4>
<p>Suppose we have the following function that takes in a URL and tuple of (word, occurrences), creates a records, and saves it to the database.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">save_to_db</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">top_word</span><span class="p">):</span>
    <span class="n">record</span> <span class="o">=</span> <span class="n">TopWord</span><span class="p">()</span>
    <span class="n">record</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
    <span class="n">record</span><span class="o">.</span><span class="n">word</span> <span class="o">=</span> <span class="n">top_word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">record</span><span class="o">.</span><span class="n">num_occurrences</span> <span class="o">=</span> <span class="n">top_word</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
    <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">record</span>
</pre></div>


<p>We test this function by passing in known information into the function we want to test; the function saves information into the database. Our test code pulls the newly saved record from the database and confirms its fields match the input we passed into the function.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_save_to_db</span><span class="p">():</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://test_url.com&quot;</span>
    <span class="n">most_common_word_details</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Python&quot;</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>

    <span class="n">word</span> <span class="o">=</span> <span class="n">save_to_db</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">most_common_word_details</span><span class="p">)</span>

    <span class="n">inserted_record</span> <span class="o">=</span> <span class="n">TopWord</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">inserted_record</span><span class="o">.</span><span class="n">url</span> <span class="o">==</span> <span class="s2">&quot;http://test_url.com&quot;</span>
    <span class="k">assert</span> <span class="n">inserted_record</span><span class="o">.</span><span class="n">word</span> <span class="o">==</span> <span class="s2">&quot;Python&quot;</span>
    <span class="k">assert</span> <span class="n">inserted_record</span><span class="o">.</span><span class="n">num_occurrences</span> <span class="o">==</span> <span class="mi">42</span>
</pre></div>


<p>Notice how this is the kind of testing we do manually to confirm things are working as expected. Automating this test saves us from having to repeatedly check this functionality each time we make a change to the code.</p>
<h3>End-to-End</h3>
<p>End-to-end tests check to see if the system meets our defined business requirements, i.e. function requirements. A common test is to trace a path through the system in the same manner application users experience. A example could be following the path of a new user in the system. Our test would create an account, "click" the link in the activate email, log-in for the first time, and have a tutorial modal pop-up.</p>
<p>We can conduct end-to-end tests through our user interface (UI) by leveraging a browser automation tool like <a href="https://selenium-python.readthedocs.io/">Selenium</a>. This creates a dependency between our UI and our tests, which results in slow tests that are brittle. A change to the front-end requires us to change the test. This is not sustainable as either our front-end will become static or our tests will not be run.</p>
<p>A better solution is to test the subcutaneous layer, i.e. the layer just below our user interface. For a web application, this would be testing the REST API, both sending in JSON and getting JSON out. Our <a href="https://martinfowler.com/bliki/SubcutaneousTest.html">subcutaneous tests</a> are our contracts with our front-end; they can be used by our front-end developers as a specification of the REST API. Frameworks like the OpenAPI Specification can help to automate this (research). Tools like Postman are sort of a UI for your rest api. you can test, debug, etc etc.</p>
<p>These tests are considered black box as we do not know not need to know anything about the implementation in order to conduct testing. This also means that test failures provide no indication of what when wrong. Here we use observability metrics like logs (how to word) to trace the test to diagnose system failure.</p>
<p>A failing test does not provide enough information for us to know exactly where to look as these tests cover a broad range of program functionality. We have to start tracing ours to find out what went wrong. Observability into the system is important.</p>
<p>It's either, it's very happy path testing. Either it worked or something horrible happened. (have a meme about this)</p>
<hr>
<h4>End-to-End Test Example</h4>
<p>Here we are using the Flask Test client to run subcutaneous testing on our REST API. There are a lot of things going on behind the scenes, the result we get, i.e. the HTTP status doesn't provide us any information other than if things worked the way we expected.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_end_to_end</span><span class="p">():</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.python.org&quot;</span><span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/top-word&quot;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="n">HTTPStatus</span><span class="o">.</span><span class="n">OK</span>
</pre></div>


<h3>Test Pyramid Recap</h3>
<p>Tests characteristics table</p>
<table>
<thead>
<tr>
<th></th>
<th>Unit Test</th>
<th>Integration Test</th>
<th>Functional Test</th>
</tr>
</thead>
<tbody>
<tr>
<td>definition</td>
<td>blah</td>
<td>blah</td>
<td>blah</td>
</tr>
<tr>
<td>scope</td>
<td>single thing</td>
<td>group of things</td>
<td>path thru system</td>
</tr>
<tr>
<td>speed</td>
<td>fast</td>
<td>slow</td>
<td>very slow</td>
</tr>
<tr>
<td>what failure indicates</td>
<td>which unit problem is in</td>
<td>group of components</td>
<td>somewhere in the system, use logging to find out</td>
</tr>
</tbody>
</table>
<h4>Resources</h4>
<ul>
<li>Martin Folwer Wiki: <a href="https://martinfowler.com/bliki/TestPyramid.html">TestPyramid</a> | <a href="https://martinfowler.com/bliki/UnitTest.html">UnitTest</a> | <a href="https://martinfowler.com/bliki/ComponentTest.html">IntegrationTest</a> | <a href="https://martinfowler.com/bliki/BroadStackTest.html">EndToEndTest</a></li>
<li>Google Testing Blog: <a href="https://testing.googleblog.com/2015/04/just-say-no-to-more-end-to-end-tests.html">Just Say No to More End-to-End Tests</a></li>
<li>Automation Panda: <a href="https://automationpanda.com/2018/08/01/the-testing-pyramid/">The Testing Pyramid</a></li>
</ul>
<hr>
<h2>Structuring Tests</h2>
<p><a name="structuring-tests"></a></p>
<p>We should structure our tests to follow the following phases:</p>
<ul>
<li>setting up the system under test (SUT) to environment required by the test case (pre-conditions)</li>
<li>performing the action we want to test on SUT</li>
<li>verifying if the expected outcome occurred (post-conditions)</li>
<li>tearing down SUT and putting the environment back into the state we found it in</li>
</ul>
<p>There are a couple of styles of test representation which make this pattern explicit: Given-When-Then and Arrange-Act-Assert.</p>
<h3>Given-When-Then (GWT)</h3>
<p>GWT provides a useful abstraction for separating the different phases of our test:</p>
<ul>
<li><strong>Given</strong> a set of pre-conditions</li>
<li><strong>When</strong> we perform an action on the SUT</li>
<li><strong>Then</strong> our post-conditions should be as follows</li>
</ul>
<p>GWT is widely used in <a href="https://en.wikipedia.org/wiki/Behavior-driven_development">Behavior Driven Development</a> (BDD); <a href="https://automationpanda.com/">Automation Panda</a> gave a <a href="https://www.youtube.com/watch?v=EtIAbfCrsFI">talk on BDD in Python at PyCon 2018</a>, it's a great introduction to BDD and <a href="https://behave.readthedocs.io/en/latest/">behave</a>, Python's BDD framework.</p>
<h4>Given-When-Then Example</h4>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_find_top_word</span><span class="p">():</span>
    <span class="c1"># Given a list of word</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;bat&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">]</span>

    <span class="c1"># When we run the function over the list</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">find_top_word</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>

    <span class="c1"># Then we should see `foo` occurring 3 times</span>
    <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;foo&quot;</span>
    <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>


<h3>Arrange-Act-Assert (AAA)</h3>
<p>The AAA pattern is another abstraction for separating the different part of our tests:</p>
<ul>
<li><strong>Arrange</strong> all necessary pre-conditions</li>
<li><strong>Act</strong> on the SUT</li>
<li><strong>Assert</strong> that the expected results have occurred</li>
</ul>
<p>This clear separation allows us to see if our test method is trying to test too many different things at once.</p>
<h4>Arrange-Act-Assert Example</h4>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_find_top_word</span><span class="p">():</span>
    <span class="c1"># Arrange</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;bat&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">]</span>

    <span class="c1"># Act</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">find_top_word</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>

    <span class="c1"># Assert</span>
    <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;foo&quot;</span>
    <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>


<p>This structure is clear and specifies exactly what is needed. It's how I write my tests.</p>
<h4>Resources</h4>
<ul>
<li>Gerard Meszaros: <a href="http://xunitpatterns.com/Four%20Phase%20Test.html">Four-Phase Test</a></li>
<li>Martin Fowler Wiki: <a href="https://martinfowler.com/bliki/GivenWhenThen.html">GivenWhenThen</a></li>
<li>C2 Wiki: <a href="http://wiki.c2.com/?ArrangeActAssert">Arrange Act Assert</a></li>
<li>James Cooke: <a href="https://jamescooke.info/arrange-act-assert-pattern-for-python-developers.html">Arrange Act Assert Pattern for Python Developers</a></li>
</ul>
<hr>
<h2>What to Test</h2>
<p><a name="what-to-test"></a></p>
<p>In order to prove that our program is correct, we have to test it against every conceivable combination of input values. This type of exhaustive testing is not practical so we need to employ testing strategies that allow us to select test cases where errors are most likely to error. Seasoned developers have experience balancing writing code to solve business problems versus writing tests to ensure correctness and prevent regression. Finding this balance and knowing what to test can feel more like an art than a science. Fortunately, there are a few rules of thumb we can follow to make sure our testing is thorough.</p>
<p>This section is adapted from Code Complete Chapter 22: Developer Testing.</p>
<h3>Functional Requirements</h3>
<p>We want to make sure that all relevant requirements have been implemented. Our test cases should be detailed enough to check business requirements. There is no point building something if doesn't meet the criteria you set forth.</p>
<h3>Basis Path Testing</h3>
<p>We have to test each statement at least once. If the statement is a conditional statement (<code>if</code> or <code>while</code>), we have to vary our testing to make sure we test all branches of the conditional. For example, if we have the following code:</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">18</span><span class="p">:</span>
    <span class="c1"># statement1</span>
<span class="k">elif</span> <span class="mi">18</span> <span class="o">&gt;=</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">35</span><span class="p">:</span>
    <span class="c1"># statement2</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># statement3</span>
</pre></div>


<p>We would have to vary our test input, <code>x</code>, to be: [1] less than 18, [2] between 18 and 35, and [3] greater than 35 to make sure we hit all branches of the conditional.</p>
<h3>Equivalence Partitioning</h3>
<p>Two test cases that result in the same output are said to be equivalent. We only require one of the test cases in order to cover that one class of errors.</p>
<h3>Boundary Analysis</h3>
<blockquote>
<p>There are 2 hard problems in computer science: cache invalidation, naming things, and off-by-1 errors.</p>
</blockquote>
<p>This is one of the <a href="https://martinfowler.com/bliki/TwoHardThings.html">oldest jokes in programming</a>. There is a lot of truth behind it, we often confuse if we need a <code>&lt;</code> or a <code>&lt;=</code>. This is why we should always test the boundary conditions. Given the following example:</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">18</span><span class="p">:</span>
    <span class="c1"># statement1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># statement3</span>
</pre></div>


<p>To ensure we thoroughly test the boundary conditions of the code snippet above, we would to have test cases for <code>x=17</code>, <code>x=18</code>, and <code>x=19</code>. Be aware that writing test cases becomes a bit more complicated if our boundary has a compound conditional.</p>
<h3>Edge Cases</h3>
<!-- TODO -->

<h3>Classes of Bad Data</h3>
<ul>
<li>Too little data (or no data)</li>
<li>Too much data</li>
<li>Invalid data</li>
<li>Wrong size of data</li>
<li>Uninitialized data</li>
</ul>
<h3>Data Flow Testing</h3>
<p>Focuses on tracing the control flow of the program with a focus on exploring the sequence of events related to the status of data objects. For example, we get an error if we try to access a variable that has been deleted. We can use Data Flow testing to come up with additional test cases for variables that have not be checked.</p>
<h3>Error Guessing</h3>
<p>Past experience can provides us insights into parts of our code base that can lead to errors. Keeping a record of errors you've made before can improve the likelihood that you will not make that error again in the future.</p>
<h3>Recap</h3>
<p>Figuring out what to test and doing it efficiently is what I mean when I say "Art of Developer Testing". The only way to get better at testing is by writing tests, coming up come up better testing strategies to blah, and learning about different testing techniques. Just like in software development, the more you know about testing, the better you will become at it.</p>
<hr>
<h2>When to Write Test</h2>
<p><a name="when-to-write-tests"></a></p>
<p>While there is a lot of interesting discussion here about when to write tests (first? last? both?), I feel it takes away from my main point. It doesn't matter when you write tests, it's about getting into the habit of writing tests in the first place.</p>
<p>If you are interested in this topic, I recommend the following links:</p>
<ul>
<li>RubyOnRails creator David Heinemeier Hansson (DHH) <a href="https://www.youtube.com/watch?v=9LfmrkyP81M">criticized TDD at RailsConf 2014</a></li>
<li><a href="https://martinfowler.com/articles/is-tdd-dead/">Is TDD Dead? discussion</a> with DHH, Martin Fowler, and Kent Beck</li>
<li><a href="https://www.tedmyoung.com/looking-at-tdd-an-academic-survey/">TDD: A Academic Survey</a> by Ted M. Young</li>
</ul>
<hr>
<h2>Testing Anti-Patterns</h2>
<p><a name="testing-anti-patterns"></a></p>
<ul>
<li>tests should be focused</li>
<li>test one thing at a time, if we have multiple things that we are testing for. a test failure won't provide any additional information. we're gonna have to do the work to dig into it, so save yourself a headache and make your tests indicate where to look. this is more true for unit tests</li>
<li>too many test cases that are the same</li>
<li>testing happy path vs testing bad path. this is because we aren't taught about how to test properly. writing tests feels like a chore. if we have the right tools, it won't. this series of posts is trying to fix that.</li>
</ul>
<hr>
<h2>Conclusion</h2>
<p><a name="conclusion"></a></p>
<p>Testing is complex. Understanding it will make you better at testing. In this post I outlined blah blah blah. I wanted to get all this knowledge out there so I can refer back to build upon it in future posts.</p>
  </div>

<div class="article-tag-list">
<span class="label label-default">Tags</span>
	<a href="../tag/art-of-developer-testing.html"><i class="fa fa-tag"></i>art-of-developer-testing</a>&nbsp;
	<a href="../tag/testing.html"><i class="fa fa-tag"></i>testing</a>&nbsp;
	<a href="../tag/python.html"><i class="fa fa-tag"></i>python</a>&nbsp;
</div>  <hr />
  <div class="well well-sm">  <!-- Social media sharing buttons -->
    <!-- Twitter -->
    <a href="https://twitter.com/share" class="twitter-share-button" 
       data-via="CaiusSivjus" >Tweet</a>&nbsp;

    <!-- Google+ -->
    <div class="g-plus" data-action="share" data-annotation="bubble"></div>
    &nbsp;&nbsp;&nbsp;&nbsp;
    <div class="g-plusone" data-size="medium"></div>&nbsp;

    <!-- Facebook -->
    <div class="fb-like" 
        data-href="../drafts/testing-101-introduction-to-testing.html" 
        data-layout="button_count" 
        data-action="like" data-show-faces="true" 
        data-share="true">
    </div>
    &nbsp;
  </div> <!-- /Social media sharing buttons -->
  <div class="comments">
	<h2>Comments</h2>
	<div id="disqus_thread"></div>
	<script type="text/javascript">
				   (function() {
						var dsq = document.createElement('script');
						dsq.type = 'text/javascript'; dsq.async = true;
						dsq.src = '//siv-scripts.disqus.com/embed.js';
						(document.getElementsByTagName('head')[0] ||
						 document.getElementsByTagName('body')[0]).appendChild(dsq);
				  })();
	</script>
  </div>
</article>
        </div><!-- /content -->

        <div class="col-md-3 sidebar-nav" id="sidebar">

<div class="row">

<div class="col-xs-6 col-md-12">
<h4><i class="fa fa-comment fa-fw fa-lg"></i> Social</h4>
<ul class="list-unstyled social-links">
    <li><a href="http://linkedin.com/in/alysivji/" target="_blank">
	  <i class="fa fa-linkedin-square fa-fw fa-lg" title="LinkedIn"></i>
		LinkedIn
	</a></li>
    <li><a href="http://github.com/alysivji" target="_blank">
	  <i class="fa fa-github-square fa-fw fa-lg" title="GitHub"></i>
		GitHub
	</a></li>
    <li><a href="https://twitter.com/CaiusSivjus" target="_blank">
	  <i class="fa fa-twitter-square fa-fw fa-lg" title="Twitter"></i>
		Twitter
	</a></li>
</ul>
</div>

<div class="col-xs-6 col-md-12">
<h4><i class="fa fa-folder fa-fw fa-lg"></i> Categories</h4>
<ul class="list-unstyled category-links">
  <li><a href="../category/data-analysis.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Data Analysis</a></li>
  <li><a href="../category/deep-dives.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Deep Dives</a></li>
  <li><a href="../category/quick-hits.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Quick Hits</a></li>
  <li><a href="../category/thoughts.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Thoughts</a></li>
  <li><a href="../category/tutorials.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Tutorials</a></li>
</ul>
</div>

</div> <!-- /row -->

<h4><i class="fa fa-tags fa-fw fa-lg"></i> Tags</h4>
<p class="tag-cloud">
    <span class="tag-2">
      <a href="../tag/terminal.html">
          <i class="fa fa-tag"></i>
        terminal
      </a>
    </span>
    <span class="tag-1">
      <a href="../tag/python.html">
          <i class="fa fa-tag"></i>
        python
      </a>
    </span>
    <span class="tag-4">
      <a href="../tag/vim.html">
          <i class="fa fa-tag"></i>
        vim
      </a>
    </span>
    <span class="tag-2">
      <a href="../tag/data-viz.html">
          <i class="fa fa-tag"></i>
        data-viz
      </a>
    </span>
    <span class="tag-3">
      <a href="../tag/flask.html">
          <i class="fa fa-tag"></i>
        flask
      </a>
    </span>
    <span class="tag-1">
      <a href="../tag/how-to.html">
          <i class="fa fa-tag"></i>
        how-to
      </a>
    </span>
    <span class="tag-2">
      <a href="../tag/exploring-pypi.html">
          <i class="fa fa-tag"></i>
        exploring-pypi
      </a>
    </span>
    <span class="tag-4">
      <a href="../tag/web-development.html">
          <i class="fa fa-tag"></i>
        web-development
      </a>
    </span>
    <span class="tag-4">
      <a href="../tag/gis.html">
          <i class="fa fa-tag"></i>
        gis
      </a>
    </span>
    <span class="tag-3">
      <a href="../tag/book.html">
          <i class="fa fa-tag"></i>
        book
      </a>
    </span>
    <span class="tag-2">
      <a href="../tag/cest-la-vie.html">
          <i class="fa fa-tag"></i>
        c'est-la-vie
      </a>
    </span>
    <span class="tag-4">
      <a href="../tag/php.html">
          <i class="fa fa-tag"></i>
        php
      </a>
    </span>
    <span class="tag-3">
      <a href="../tag/software-engineering.html">
          <i class="fa fa-tag"></i>
        software-engineering
      </a>
    </span>
    <span class="tag-2">
      <a href="../tag/pythonic.html">
          <i class="fa fa-tag"></i>
        pythonic
      </a>
    </span>
    <span class="tag-2">
      <a href="../tag/workflow.html">
          <i class="fa fa-tag"></i>
        workflow
      </a>
    </span>
    <span class="tag-2">
      <a href="../tag/docker.html">
          <i class="fa fa-tag"></i>
        docker
      </a>
    </span>
    <span class="tag-2">
      <a href="../tag/pandas.html">
          <i class="fa fa-tag"></i>
        pandas
      </a>
    </span>
    <span class="tag-4">
      <a href="../tag/math.html">
          <i class="fa fa-tag"></i>
        math
      </a>
    </span>
    <span class="tag-2">
      <a href="../tag/reddit-scraper.html">
          <i class="fa fa-tag"></i>
        reddit-scraper
      </a>
    </span>
    <span class="tag-2">
      <a href="../tag/testing.html">
          <i class="fa fa-tag"></i>
        testing
      </a>
    </span>
    <span class="tag-2">
      <a href="../tag/review.html">
          <i class="fa fa-tag"></i>
        review
      </a>
    </span>
    <span class="tag-2">
      <a href="../tag/productivity.html">
          <i class="fa fa-tag"></i>
        productivity
      </a>
    </span>
    <span class="tag-2">
      <a href="../tag/mongodb.html">
          <i class="fa fa-tag"></i>
        mongodb
      </a>
    </span>
    <span class="tag-4">
      <a href="../tag/elasticsearch.html">
          <i class="fa fa-tag"></i>
        elasticsearch
      </a>
    </span>
    <span class="tag-3">
      <a href="../tag/grad-school.html">
          <i class="fa fa-tag"></i>
        grad-school
      </a>
    </span>
    <span class="tag-2">
      <a href="../tag/data-science.html">
          <i class="fa fa-tag"></i>
        data-science
      </a>
    </span>
    <span class="tag-3">
      <a href="../tag/web-scraping.html">
          <i class="fa fa-tag"></i>
        web-scraping
      </a>
    </span>
</p>
<h4><i class="fa fa-rss fa-fw fa-lg"></i> Feeds</h4>
<ul class="list-unstyled">
    <li><a href="http://alysivji.github.io/feeds/all.atom.xml" 
		   type="application/atom+xml" rel="alternate">
		<i class="fa fa-rss-square fa-fw fa-lg"></i> Atom Feed</a></li>
</ul>

<hr />

        </div><!--/sidebar -->
      </div><!--/row-->
    </div><!--/.container /#main-container -->

    <footer id="site-footer">
      <address id="site-colophon">
        <p class="text-center text-muted">
        Site built using <a href="http://getpelican.com/" target="_blank">Pelican</a>
        &nbsp;&bull;&nbsp; Theme based on
        <a href="http://www.voidynullness.net/page/voidy-bootstrap-pelican-theme/"
           target="_blank">VoidyBootstrap</a> by
        <a href="http://www.robertiwancz.com/"
           target="_blank">RKI</a>
        </p>
      </address><!-- /colophon  -->
    </footer>

<!-- DISQUS script for displaying comment count -->
<script type="text/javascript">
    var disqus_shortname = 'siv-scripts';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

    <!-- javascript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>


<!-- Facebook -->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script>

<!-- Twitter -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Google+ -->
<!-- Synchronous 
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
-->
<!-- Asynchronous -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/platform.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>  </body>
</html>