<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="Aly Sivji" />
    <meta name="generator" content="Pelican (VoidyBootstrap theme)" />
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Building a Flask Web Application (Flask Part 2)"/>
    <meta property="og:url" content="./flask-part2-building-a-flask-web-application.html"/>
      <meta property="article:section" content="Tutorials"/>
        <meta property="article:tag" content="python"/>
        <meta property="article:tag" content="how-to"/>
        <meta property="article:tag" content="flask"/>
        <meta property="article:tag" content="mongodb"/>
        <meta property="article:tag" content="reddit-scraper"/>
        <meta property="og:image"
              content="https://alysivji.github.io/images/main/siv.jpeg"/>
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Building a Flask Web Application (Flask Part 2)">
    <meta name="twitter:description" content="">
    <meta name="twitter:site" content="@CaiusSivjus">
    <meta name="twitter:creator" content="@CaiusSivjus">
    <meta name="twitter:domain" content=".">
        <meta property="twitter:image"
              content="https://alysivji.github.io/images/main/siv.jpeg"/>

    <title>Building a Flask Web Application (Flask Part 2) - Siv Scripts</title>

        <link rel="stylesheet"
              href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
              integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
              crossorigin="anonymous" />
      <link rel="stylesheet"
            href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
            integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
            crossorigin="anonymous">


      <link rel="stylesheet" href="./theme/css/tango.css" />
      <link rel="stylesheet" href="./theme/css/voidybootstrap.css" />
      <link rel="stylesheet" href="./theme/css/dataframe.css" />
      <link rel="stylesheet" href="./theme/css/custom.css" />

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js" integrity="sha384-FFgGfda92tXC8nCNOxrCQ3R8x1TNkMFqDZVQdDaaJiiVbjkPBXIJBx0o7ETjy8Bh" crossorigin="anonymous"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js" integrity="sha384-ZoaMbDF+4LeFxg6WdScQ9nnR1QC2MIRxA1O9KWEXQwns1G8UNyIEZIQidzb0T1fo" crossorigin="anonymous"></script>
    <![endif]-->

    <link rel="shortcut icon" href="./files/favicon.ico" />
        <link href="http://alysivji.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Siv Scripts Atom Feed" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-90986575-1', '');
  ga('send', 'pageview');

</script>
  </head>

  <body>
    <nav class="navbar navbar-default">
      <div class="container">
	   <div class="navbar-header">
		<button type="button" class="navbar-toggle"
				data-toggle="collapse" data-target="#main-navbar-collapse">
		  <span class="sr-only">Toggle navigation</span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		</button>
		<a class="navbar-brand" href="./" rel="home">
          <i class="fa fa-home fa-fw fa-lg"> </i> </a>
       </div>

      <div class="collapse navbar-collapse" id="main-navbar-collapse">
        <ul class="nav navbar-nav">
              <li>
                <a href="./pages/about.html">About</a>
              </li>
              <li>
                <a href="./pages/talks.html">Talks</a>
              </li>
            <li class="divider"></li>
            <li class="">
              <a href="./archives.html">Archives</a>
            </li>
          <li class="divider"></li>
            <li><a href="http://alysivji.github.io/feeds/all.atom.xml"
                   type="application/atom+xml" rel="alternate">
                <i class="fa fa-rss fa-fw fa-lg"></i> </a></li>
        </ul> <!-- /nav -->
      </div> <!-- /navbar-collapse -->
	  </div> <!-- /container -->
    </nav> <!-- /navbar -->

	<div class="jumbotron" id="overview">
	  <div class="container">
		<h1><a href="./">Siv Scripts</a></h1>
		<p class="lead">Solving Problems Using Code</p>
	  </div>
	</div>

    <div class="container" id="main-container">
      <div class="row">
        <div class="col-md-9" id="content">
<article itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
  <header class="article-header">
<abbr class="article-header-date">
  Tue 11 April 2017
</abbr> <h1>
  <a href="./flask-part2-building-a-flask-web-application.html" rel="bookmark"
     title="Permalink to Building a Flask Web Application (Flask Part 2)">
    Building a Flask Web Application (Flask Part 2)
  </a>
</h1><div class="article-header-info">
  <p>
      Posted by <a href="./author/aly-sivji.html">Aly Sivji</a>
    in 
    <a href="./category/tutorials.html">
      Tutorials</a>
    &nbsp;&nbsp;
  </p>
</div> <!-- /.article-header-info -->  </header>
  <div class="content-body" itemprop="text articleBody">
	<p>(Note: This post is part of my <a href="https://alysivji.github.io/tag/reddit-scraper.html">reddit-scraper series</a>)</p>
<blockquote>
<h4>Summary</h4>
<ul>
<li>Web frameworks intro</li>
<li>Explore the Flask microframework</li>
<li>Understand the Model-View-Controller (MVC) pattern</li>
<li>Build Flask web app</li>
</ul>
</blockquote>
<hr>
<p><a href="https://alysivji.github.io/flask-part1-generating-html-pages-with-mongoengine-jinja2.html">Last time</a> we started our web application adventure by learning how to generate dynamic HTML webpages from data stored in MongoDB using MongoEngine and Jinja2. In this post, we will leverage the <a href="http://flask.pocoo.org/">Flask microframework</a> to serve the webpages we render to our users.</p>
<p>Specifically we will explore the Flask library, learn about the Model-View-Controller (MVC) design pattern, and discuss how Flask fits into MVC by building our first Flask web application to display <a href="https://alysivji.github.io/mongodb-pipelines-in-scrapy.html">scraped data stored in MongoDB</a>.</p>
<hr>
<h2>What You Need to Follow Along</h2>
<h3>Development Tools (Stack)</h3>
<ul>
<li><a href="https://www.python.org/downloads/">Python 3</a></li>
<li><a href="https://docs.mongodb.com/manual/installation/">MongoDB</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/installation/">Flask</a></li>
<li><a href="https://flask-mongoengine.readthedocs.io/en/latest/">Flask-MongoEngine</a></li>
</ul>
<h3>Code</h3>
<ul>
<li><a href="https://github.com/alysivji/reddit-top-posts-website-flask">Github Repo</a> - Tag: <a href="https://github.com/alysivji/reddit-top-posts-website-flask/tree/blog-flask-part2">blog-flask-part2</a></li>
</ul>
<p>We can checkout the code from the git repository as follows:</p>
<div class="highlight"><pre><span></span><span class="gp">$</span> git checkout tags/blog-flask-part2
<span class="go">Note: checking out &#39;tags/blog-flask-part2&#39;.</span>
</pre></div>


<p>Or we can use <a href="http://kinolien.github.io/gitzip/">GitZip</a> to download the tagged commit by URL.</p>
<hr>
<h2>Introduction to Web Frameworks</h2>
<p>What is a web framework? When should we use one?</p>
<p>A web framework is a library that allows us to "write web applications or services without having to handle low-level details such as protocols, sockets or process/thread management". The majority of Python web frameworks are "exclusively server-side technologies" (i.e. render pages on the server before sending to users), but they are increasingly supporting client-side technologies (like Ajax -- think <a href="https://www.google.com/maps">Google Maps</a>) to provide users with rich, interactive experiences in the browser (<a href="https://wiki.python.org/moin/WebFrameworks">Source</a>).</p>
<p>Some common tasks that web frameworks can handle include:</p>
<ul>
<li>URL routing</li>
<li>HTML, XML, JSON, and other output format templating</li>
<li>Database manipulation</li>
<li>Security against Cross-site request forgery (CSRF) and other attacks</li>
<li>Session storage and retrieval</li>
</ul>
<p><a href="https://www.fullstackpython.com/web-frameworks.html">(from Full Stack Python)</a></p>
<p>There are <a href="https://wiki.python.org/moin/WebFrameworks">no shortage of Python web frameworks</a> for us to use; their functionality falls on the spectrum of "executing a single use case to providing every known feature" to developers (the <strong>batteries included</strong> approach) (<a href="https://www.fullstackpython.com/web-frameworks.html">Source</a>). O'Reilly released a <a href="https://www.oreilly.com/learning/python-web-frameworks">short, but detailed, e-book</a> that examines the entire Python web framework ecosystem and provides detailed analysis of the 6 most widely used libraries: <a href="https://www.djangoproject.com/">Django</a>, <a href="http://flask.pocoo.org/">Flask</a>, <a href="http://www.tornadoweb.org/">Tornado</a>, <a href="https://bottlepy.org/">Bottle</a>, <a href="https://trypyramid.com/">Pyramid</a>, and <a href="http://cherrypy.org/">CherryPy</a>.</p>
<p>For our use case, we will be creating and deploying a Flask web application.</p>
<h4>Additional Resources</h4>
<ul>
<li><a href="http://www.codingdojo.com/blog/choosing-python-web-frameworks/">Choosing Python Web Frameworks: Django and Flask</a> - Coding Dojo</li>
<li><a href="https://wakatime.com/blog/14-pirates-use-flask-the-navy-uses-django">Pirates use Flask, the Navy uses Django</a> - WakaTime Blog</li>
<li><a href="http://stackoverflow.com/questions/12781655/flask-or-django-for-a-beginner">Flask or Django for a beginner?</a> - StackOverflow <em>(Praise Be)</em><ul>
<li>Synopsis: Start with Flask, switch to Django if we need to scale</li>
</ul>
</li>
<li><a href="https://www.tivix.com/blog/django-vs-flask-picking-the-right-python-framework">Django vs. Flask: Picking the Right Python Web Framework</a> - Tivix</li>
</ul>
<hr>
<h2>Flask</h2>
<p><a name="flask-overview"></a></p>
<p>In the <a href="https://alysivji.github.io/flask-part1-generating-html-pages-with-mongoengine-jinja2.html">previous post</a>, we briefly mentioned that Flask is the best Python web framework for our use case. What does this mean? In this section, we will introduce Flask and discuss the features that make it so popular.</p>
<p>As the name implies, the <a href="http://flask.pocoo.org/">Flask microframework</a> is a lightweight web framework that we can extend to get the functionality we require.</p>
<p>From the <a href="http://flask.pocoo.org/docs/0.12/foreword/">documentation</a>:</p>
<blockquote>
<p>Flask aims to keep the core simple but extensible. Flask won’t make many decisions for you, such as what database to use. Those decisions that it does make, such as what templating engine to use, are easy to change. Everything else is up to you, so that Flask can be everything you need and nothing you don’t.</p>
</blockquote>
<p>Taking a build-your-own framework approach to web development allows us to get projects off the ground quickly; we only use the extensions we require for our specific use case. With <a href="http://flask.pocoo.org/docs/0.12/quickstart/">just a few lines of code</a>, we can create a website with:</p>
<ul>
<li><a href="http://flask.pocoo.org/docs/0.12/quickstart/#routing">URL routing</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/quickstart/#rendering-templates">template rendering</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/quickstart/#accessing-request-data">two</a>-<a href="http://flask.pocoo.org/docs/0.12/quickstart/#message-flashing">way</a> client communication</li>
<li><a href="http://flask.pocoo.org/docs/0.12/quickstart/#redirects-and-errors">redirects and error handling</a></li>
<li><a href="http://flask.pocoo.org/docs/0.12/quickstart/#logging">logging</a></li>
</ul>
<p>The Flask documentation has great advice on <a href="http://flask.pocoo.org/docs/0.12/foreword/#growing-with-flask">how to grow</a> and <a href="http://flask.pocoo.org/docs/0.12/becomingbig/">become big</a> with Flask. We can also leverage the list of <a href="http://flask.pocoo.org/docs/0.12/patterns/">common design patterns</a> to ensure we are following best practices as outline by the project contributors.</p>
<h5>Notes</h5>
<ul>
<li>Check out the <a href="http://flask.pocoo.org/extensions/">Flask Extension Registry</a> to see a list of ready-made features we can hook into our web app.</li>
<li>Extensions such as <a href="http://flask-diamond.readthedocs.io/en/latest/">Flask-Diamond</a> can turn Flask into a batteries-included web framework. This extension provides scaffolding for features such as: account management, administrative access, databases, email, testing, documentation, deployment, and more. This library was featured in <a href="https://talkpython.fm/episodes/show/97/flask-django-style-with-flask-diamond">Episode 98</a> of the <a href="https://talkpython.fm/">Talk Python to Me</a> podcast. I will be using Flask-Diamond for a work project in the next couple of months and will blog about my experience once the application is in production.</li>
<li><a href="https://github.com/sloria/cookiecutter-flask">Cookiecutter Flask</a> is batteries-included library based on the <a href="http://getbootstrap.com/">Bootstrap template</a>.</li>
<li><a href="http://exploreflask.com/en/latest/index.html">Explore Flask</a> is an online resource detailing best practices and patterns for developing web applications with Flask.</li>
</ul>
<hr>
<p><a name="model-view-controller"></a></p>
<h2>Model-View-Controller</h2>
<p>Model–View–Controller (MVC) is an architectural pattern for implementing user interfaces. It divides an application into three interconnected parts: the Model, the View, and the Controller. Separating the "internal representations of information from the ways that information is presented to and accepted from the user" allows us to increase modularity for simultaneous development and code reuse (<a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">Source</a>).</p>
<p>Each of the components is defined as follows:<br />
<img src="/images/01-09/4_mvc_components_description.png" alt="Description of MVC Components" width=600/></p>
<h3>Interactions Betweeen Components</h3>
<p>The MVC design pattern also defines interactions between components, as we can see in the following diagram <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">from Wikipedia</a>:<br />
<img src="/images/01-09/4_mvc_diagram.png" alt="Diagram of interactions within the MVC pattern (from Wikipedia)" width=360/></p>
<ul>
<li>The <strong>model</strong> stores data that is retrieved according to commands from the <strong>controller</strong></li>
<li>The <strong>view</strong> generates output for the user based on changes in the <strong>model</strong></li>
<li>The <strong>controller</strong> acts on both <strong>model</strong> and <strong>view</strong>; it sends commands to the <strong>model</strong> to update its state and to the <strong>view</strong> to change information presented to users</li>
</ul>
<p>In the next section, we will examine how Flask fits into the MVC framework by building our first web application.</p>
<h4>Additional Resources</h4>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">Model–view–controller</a> - Wikipedia</li>
<li><a href="http://softwareengineering.stackexchange.com/questions/127624/what-is-mvc-really">What is MVC, really?</a> - StackOverflow <em>(Praise Be)</em></li>
<li><a href="https://realpython.com/blog/python/the-model-view-controller-mvc-paradigm-summarized-with-legos/">Model-View-Controller (MVC) Explained -- With Legos</a> - Real Python</li>
<li><a href="http://www.tomdalling.com/blog/software-design/model-view-controller-explained/">Model View Controller Explained</a> - Tom Dalling</li>
<li><a href="https://www.tutorialspoint.com/design_pattern/mvc_pattern.htm">Design Patterns - MVC Pattern</a> - Tutorials Point</li>
</ul>
<hr>
<h2>Building Reddit Top Post Web App</h2>
<p>Using the Flask <a href="http://flask.pocoo.org/docs/0.12/quickstart/#quickstart">Quickstart</a> and <a href="http://flask.pocoo.org/docs/0.12/tutorial/#tutorial">Tutorial</a> as reference, let's open up our favorite text editor and start coding!</p>
<h3>Model</h3>
<p>In the <a href="https://alysivji.github.io/flask-part1-generating-html-pages-with-mongoengine-jinja2.html">previous post</a>, we utilized the MongoEngine ORM library to pull data out of MongoDB. We modify our code to get the following:</p>
<div class="highlight"><pre><span></span><span class="c1"># models.py</span>

<span class="kn">from</span> <span class="nn">flask_mongoengine</span> <span class="kn">import</span> <span class="n">MongoEngine</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">MongoEngine</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">Post</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Document</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Class for defining structure of reddit-top-posts collection</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">URLField</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">date_str</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">commentsUrl</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">URLField</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">sub</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># subredit can be 20 chars</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">StringField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># title can be 300 chars</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">IntField</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">meta</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;collection&#39;</span><span class="p">:</span> <span class="s1">&#39;top_reddit_posts&#39;</span><span class="p">,</span> <span class="c1"># collection name</span>
        <span class="s1">&#39;ordering&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-score&#39;</span><span class="p">],</span> <span class="c1"># default ordering</span>
        <span class="s1">&#39;auto_create_index&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="c1"># MongoEngine will not create index</span>
        <span class="p">}</span>
</pre></div>


<h5>Note</h5>
<ul>
<li>We are using the <a href="https://flask-mongoengine.readthedocs.io/en/latest/">Flask-MongoEngine</a> library instead of the MongoEngine library. This Flask specific library adds <a href="https://flask-mongoengine.readthedocs.io/en/latest/#mongoengine-and-wtforms">support for forms</a> (via <a href="https://wtforms.readthedocs.io/en/latest/">WTForms</a>), <a href="https://flask-mongoengine.readthedocs.io/en/latest/#custom-queryset">error handling</a> (i.e. <a href="https://en.wikipedia.org/wiki/HTTP_404">404</a> support), <a href="https://flask-mongoengine.readthedocs.io/en/latest/#custom-queryset">results pagination</a>, and the <a href="https://flask-mongoengine.readthedocs.io/en/latest/#session-interface">use of MongoDB as a session store</a>.</li>
</ul>
<h3>Controller</h3>
<p>The code for the controller can be split into three sections: initialization, routing, and execution.</p>
<h4>Initialization</h4>
<p>After creating a Flask instance, we set our <a href="http://flask.pocoo.org/docs/0.12/config/">configuration options</a> and connect our database to the current instance.</p>
<p>Since Flask is instance based, we create an instance and configure the settings for that instance. This allows us to have <a href="https://damyanon.net/flask-series-configuration/">multiple processes, each with a different configuration</a>.</p>
<div class="highlight"><pre><span></span><span class="c1"># app.py (1/3)</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span>
<span class="kn">from</span> <span class="nn">models</span> <span class="kn">import</span> <span class="n">db</span><span class="p">,</span> <span class="n">Post</span>

<span class="c1"># initialize instance of WSGI application</span>
<span class="c1"># act as a central registry for the view functions, URL rules, template configs</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1">## include db name in URI; _HOST entry overwrites all others</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;MONGODB_HOST&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mongodb://localhost:27017/sivji-sandbox&#39;</span>
<span class="n">app</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1"># initalize app with database</span>
<span class="n">db</span><span class="o">.</span><span class="n">init_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</pre></div>


<h5>Notes</h5>
<ul>
<li>The Flask API docs provide information on the <a href="http://flask.pocoo.org/docs/0.12/api/#flask.Flask">first parameter we pass into</a> the <code>flask.Flask()</code> function (i.e. <code>__name__</code>).</li>
<li>We will be leveraging Flask's <a href="http://flask.pocoo.org/docs/0.12/quickstart/#debug-mode">Debug Mode</a> to help us find bugs in our code as we are developing.</li>
</ul>
<h4>Routing</h4>
<p>Flask requires us to <a href="http://flask.pocoo.org/docs/0.12/quickstart/#routing">define URL routes</a> for our web application so it knows which pages to display/render when users access specific URLs.</p>
<p><a href="https://realpython.com/blog/python/the-model-view-controller-mvc-paradigm-summarized-with-legos/">From Real Python</a>:</p>
<blockquote>
<p>Each route is associated with a controller – more specifically, a certain function within a controller, known as a controller action. So when you enter a URL, the application attempts to find a matching route, and, if it’s successful, it calls that route’s associated controller action.</p>
<p>Within the controller action, two main things typically occur: the models are used to retrieve all of the necessary data from a database; and that data is passed to a view, which renders the requested page. The data retrieved via the models is generally added to a data structure (like a list or dictionary), and that structure is what’s sent to the view.</p>
</blockquote>
<p>We use <a href="http://flask.pocoo.org/docs/0.12/patterns/viewdecorators/#templating-decorator">decorators</a> to define URL routes in our application instance. What's a decorator? Great question! <a href="http://thecodeship.com/patterns/guide-to-python-function-decorators/">Check out this primer on function decorators in Python</a>.</p>
<div class="highlight"><pre><span></span><span class="c1"># app.py (2/3)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="c1">## get the last date the webscraper was run</span>
    <span class="k">for</span> <span class="n">post</span> <span class="ow">in</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="p">()</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="n">date_str</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-date_str&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">day_to_pull</span> <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">date_str</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span>
        <span class="s1">&#39;index.html&#39;</span><span class="p">,</span>
        <span class="n">Post</span><span class="o">=</span><span class="n">Post</span><span class="p">,</span>
        <span class="n">day_to_pull</span><span class="o">=</span><span class="n">day_to_pull</span>
        <span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/date&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">all_dates</span><span class="p">():</span>
    <span class="c1">## get all the dates the scraper was run on</span>
    <span class="n">dates</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="p">()</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="n">date_str</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">(</span><span class="s1">&#39;date_str&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span>
        <span class="s1">&#39;all-dates.html&#39;</span><span class="p">,</span>
        <span class="n">dates</span><span class="o">=</span><span class="nb">reversed</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dates</span><span class="p">))</span> <span class="c1"># latest date on top</span>
        <span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/date/&lt;day_to_pull&gt;&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">by_date</span><span class="p">(</span><span class="n">day_to_pull</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span>
        <span class="s1">&#39;index.html&#39;</span><span class="p">,</span>
        <span class="n">Post</span><span class="o">=</span><span class="n">Post</span><span class="p">,</span>
        <span class="n">day_to_pull</span><span class="o">=</span><span class="n">day_to_pull</span>
        <span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/sub&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">all_subs</span><span class="p">():</span>
    <span class="c1">## get all the dates the scraper was run on</span>
    <span class="n">subs</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="p">()</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="n">sub</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">(</span><span class="s1">&#39;sub&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span>
        <span class="s1">&#39;all-subreddits.html&#39;</span><span class="p">,</span>
        <span class="n">subs</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">subs</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span> <span class="c1"># sort list of subreddits</span>
        <span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/sub/&lt;sub_to_pull&gt;&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">by_subreddit</span><span class="p">(</span><span class="n">sub_to_pull</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span>
        <span class="s1">&#39;by-subreddit.html&#39;</span><span class="p">,</span>
        <span class="n">Post</span><span class="o">=</span><span class="n">Post</span><span class="p">,</span>
        <span class="n">sub</span><span class="o">=</span><span class="n">sub_to_pull</span>
        <span class="p">)</span>
</pre></div>


<h5>Notes</h5>
<ul>
<li>URL routes can <a href="http://flask.pocoo.org/docs/0.12/quickstart/#variable-rules">include variables in their definitions</a> allowing us to customize our queries to get the exact information requested.</li>
<li>We use <a href="http://docs.mongoengine.org/guide/querying.html">MongoEngine to query our database</a> to get the recordset defined by our various routes.</li>
<li>Flask supports <a href="http://flask.pocoo.org/docs/0.12/quickstart/#http-methods">all HTTP request methods</a>.</li>
<li>Controllers pass data into view templates and then render HTML using Jinja2. We will cover this topic in the <code>View</code> section.</li>
</ul>
<h4>Execution</h4>
<p>To run our Flask application, we can add the following code to our <code>app.py</code> module to ensure it executes when it's <a href="http://stackoverflow.com/questions/419163/what-does-if-name-main-do">run as a script</a>.</p>
<div class="highlight"><pre><span></span><span class="c1"># app.py (3/3)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>


<h3>View</h3>
<p>As we mentioned before, the view is the user interface (UI) of our web application which renders data from the model as defined by our template. If this sounds familiar, it's because it is. <a href="https://alysivji.github.io/flask-part1-generating-html-pages-with-mongoengine-jinja2.html">We have already used the Jinja2 Templating Engine to generate HTML webpages</a>. In this section, we will build upon our previous work and leverage the concept of <a href="http://jinja.pocoo.org/docs/2.9/templates/#template-inheritance">Jinja template inheritance</a> to create complex applications using an inheritance hierarchy.</p>
<p>Let's start off by acknowledging that as programmers, we aren't designers, but this shouldn't limit our ability to produce web app with attractive UIs. Like everything else in development, we can stand on the shoulders of giants and use templates created by those who came before us. The <a href="https://html5boilerplate.com/">HTML5 Boilerplate</a> is a popular front-end template we can use to kickstart our project.</p>
<p>Using <a href="http://www.creativebloq.com/web-design/how-use-html-boilerplate-11513798">this post on how to use the HTML5 Boilerplate</a> as a reference, let's get our hands dirty and create templates for our Reddit Top Posts website. Download and extract a copy of the <a href="http://www.initializr.com/try">Responsive Template</a> (<a href="http://verekia.com/initializr/responsive-template/">docs</a>) from <a href="http://www.initializr.com/">initializr.com</a>:</p>
<p><img src="/images/01-09/4_download_responsive_template.png" alt="Download Reponsive Template" width=600/></p>
<p>Since Flask looks for Jinja2 files in the <a href="http://flask.pocoo.org/docs/0.12/quickstart/#rendering-templates"><code>templates</code> folder</a> and javascript/css files in the <a href="http://flask.pocoo.org/docs/0.12/quickstart/#static-files"><code>static</code> folder</a>, we will structure our application folder as follows:</p>
<div class="highlight"><pre><span></span><span class="go">.</span>
<span class="go">├── app.py</span>
<span class="go">├── models.py</span>
<span class="go">├── static</span>
<span class="go">│   ├── css</span>
<span class="go">│   │   ├── main.css</span>
<span class="go">│   │   ├── normalize.css</span>
<span class="go">│   │   └── normalize.min.css</span>
<span class="go">│   └── js</span>
<span class="go">│       ├── main.js</span>
<span class="go">│       └── vendor</span>
<span class="go">│           ├── jquery-1.11.2.min.js</span>
<span class="go">│           └── modernizr-2.8.3-respond-1.4.2.min.js</span>
<span class="go">├── status</span>
<span class="go">└── templates</span>
<span class="go">    ├── 404.html</span>
<span class="go">    ├── all-dates.html</span>
<span class="go">    ├── all-subreddits.html</span>
<span class="go">    ├── base.html</span>
<span class="go">    ├── by-subreddit.html</span>
<span class="go">    └── index.html</span>
</pre></div>


<h4>Base Template</h4>
<p>Using the concepts of <a href="http://jinja.pocoo.org/docs/2.9/templates/#template-inheritance">Jinja2 template inheritence</a> to create our hierarchy of views, we create our base template as follows:</p>
<div class="highlight"><pre><span></span><span class="c">&lt;!--templates/base.html--&gt;</span>

<span class="cp">&lt;!doctype html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;no-js&quot;</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;X-UA-Compatible&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;IE=edge,chrome=1&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Reddit Top Posts - {% block title %} {% endblock %}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;description&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1&quot;</span><span class="p">&gt;</span>

        <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;../static/css/normalize.min.css&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;../static/css/main.css&quot;</span><span class="p">&gt;</span>

        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;../static/js/vendor/modernizr-2.8.3-respond-1.4.2.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>

        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;header-container&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">header</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;wrapper clearfix&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;title&quot;</span><span class="p">&gt;</span>Reddit Top Posts<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">nav</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;index&#39;) }}&quot;</span><span class="p">&gt;</span>Home<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>Log In<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>Sign Up<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">header</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;main-container&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;main wrapper clearfix&quot;</span><span class="p">&gt;</span>

                <span class="p">&lt;</span><span class="nt">article</span><span class="p">&gt;</span>
                    {% block content %}

                    {% endblock %}
                <span class="p">&lt;/</span><span class="nt">article</span><span class="p">&gt;</span>

                <span class="p">&lt;</span><span class="nt">aside</span><span class="p">&gt;</span>
                    {% block aside %}
                        <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;all_dates&#39;) }}&quot;</span><span class="p">&gt;</span>Select by Date<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>

                        <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;all_subs&#39;) }}&quot;</span><span class="p">&gt;</span>Select by Subreddit<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
                    {% endblock %}
                <span class="p">&lt;/</span><span class="nt">aside</span><span class="p">&gt;</span>

            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span> <span class="c">&lt;!-- #main --&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span> <span class="c">&lt;!-- #main-container --&gt;</span>

        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;footer-container&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">footer</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;wrapper&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">h5</span><span class="p">&gt;</span><span class="ni">&amp;copy;</span> Copyright 2017 by <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;http://alysivji.github.io&quot;</span><span class="p">&gt;</span>Aly Sivji<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">h5</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">footer</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="nb">window</span><span class="p">.</span><span class="nx">jQuery</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s1">&#39;&lt;script src=&quot;../static/js/vendor/jquery-1.11.2.min.js&quot;&gt;&lt;\/script&gt;&#39;</span><span class="p">)&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;../static/js/main.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>


<h5>Notes</h5>
<ul>
<li><a href="http://jinja.pocoo.org/docs/2.9/templates/#child-template">Child templates</a> can replace the default content of items in between <code>{% block %}</code> and <code>{% endblock %}</code> tags.</li>
<li>The <a href="http://flask.pocoo.org/docs/0.12/api/#flask.url_for"><code>url_for()</code> method</a> can generate URL endpoints</li>
<li>We changed the paths to the files in the <code>static</code> folder to match our new web application directory structure.</li>
</ul>
<h4>Child Templates</h4>
<p>Each of our child templates will display a different view of our data. We will design our views as follows:<br/>
<img src="/images/01-09/4_templates_for_each_view.png" alt="Child Templates for Each View" width=600/></p>
<div class="highlight"><pre><span></span><span class="c">&lt;!--templates/index.html--&gt;</span>

{% extends &quot;base.html&quot; %}

{% block title %}Index{% endblock %}

{% block content %}
    <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Last Run: {{ day_to_pull }}<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;posts&quot;</span><span class="p">&gt;</span>
        {% for selected_sub in Post.objects(date_str__gte=day_to_pull).distinct(&#39;sub&#39;) %}
            <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>{{ selected_sub }}<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>

            {% for post in Post.objects(date_str__gte=day_to_pull, sub=selected_sub) %}
                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ post.url }}&quot;</span><span class="p">&gt;</span>{{ post.title }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> (Score: {{ post.score }} | <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot; {{ post.commentsUrl }}&quot;</span><span class="p">&gt;</span>Comments<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>)<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
            {% endfor %}

        {% endfor %}
    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
{% endblock %}
</pre></div>


<div class="highlight"><pre><span></span><span class="c">&lt;!--templates/by_subreddits.html--&gt;</span>

{% extends &quot;base.html&quot; %}

{% block title %}Index{% endblock %}

{% block content %}
    <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Selected Sub-Reddit: {{ sub }}<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>

    {% for date in Post.objects(sub=sub).fields(date_str=1).distinct(&#39;date_str&#39;) %}
        <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>{{ date }}<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>

        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;posts&quot;</span><span class="p">&gt;</span>
            {% for post in Post.objects(date_str=date, sub=sub).order_by(&#39;-date_str&#39;) %}
                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ post.url }}&quot;</span><span class="p">&gt;</span>{{ post.title }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> (Score: {{ post.score }} | <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot; {{ post.commentsUrl }}&quot;</span><span class="p">&gt;</span>Comments<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>)<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
            {% endfor %}
        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>

    {% endfor %}
{% endblock %}
</pre></div>


<div class="highlight"><pre><span></span><span class="c">&lt;!--templates/all-dates.html--&gt;</span>

{% extends &quot;base.html&quot; %}

{% block title %}By Date{% endblock %}

{% block content %}
    <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Available Dates<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>

        {% for date in dates %}
            <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;by_date&#39;, day_to_pull=date) }}&quot;</span><span class="p">&gt;</span>{{ date }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        {% endfor %}

{% endblock %}
</pre></div>


<div class="highlight"><pre><span></span><span class="c">&lt;!--templates/all-subreddits.html--&gt;</span>

{% extends &quot;base.html&quot; %}

{% block title %}By Sub-Reddit{% endblock %}

{% block content %}
    <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Available Sub-Reddits<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>

        {% for sub in subs %}
            <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;by_subreddit&#39;, sub_to_pull=sub) }}&quot;</span><span class="p">&gt;</span>{{ sub }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        {% endfor %}

{% endblock %}
</pre></div>


<p>That's it. We can now run our web app.</p>
<hr>
<h2>Running Flask Application</h2>
<p>Let's run the app:</p>
<div class="highlight"><pre><span></span><span class="gp">$</span> python app.py
<span class="go">* Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)</span>
<span class="go">* Restarting with stat</span>
<span class="go">* Debugger is active!</span>
<span class="go">* Debugger pin code: 302-658-435</span>
</pre></div>


<p>We'll open the page in a browser: <br />
<img src="/images/01-09/4_running_flask_app.png" alt="Child Templates for Each View" width=700/></p>
<p>Looks good!</p>
<h5>Notes</h5>
<ul>
<li>In the CSS, I changed the color of the Responsive template from orange to blue as I will be using this template for a few work projects.</li>
</ul>
<hr>
<h2>Conclusion</h2>
<p>In this post, we looked at different ways of getting data out of MongoDB and into the hands of our user. We covered Python web frameworks, explored the Flask microframework, learned about the Model-View-Controller design pattern, and created our first Flask web application.</p>
<hr>
<h2>Next Steps</h2>
<p>The next post in this series on Flask will delve into testing; specifically, unit testing in Flask using the <code>unittest</code> module from the <a href="https://docs.python.org/3/library/index.html">Python Standard Library</a>. Unit testing will allow us to create tests which can ensure our program functionality does not change as we implement additional features to this project.</p>
  </div>

<div class="article-tag-list">
<span class="label label-default">Tags</span>
	<a href="./tag/python.html"><i class="fa fa-tag"></i>python</a>&nbsp;
	<a href="./tag/how-to.html"><i class="fa fa-tag"></i>how-to</a>&nbsp;
	<a href="./tag/flask.html"><i class="fa fa-tag"></i>flask</a>&nbsp;
	<a href="./tag/mongodb.html"><i class="fa fa-tag"></i>mongodb</a>&nbsp;
	<a href="./tag/reddit-scraper.html"><i class="fa fa-tag"></i>reddit-scraper</a>&nbsp;
</div>  <hr />
  <div class="well well-sm">  <!-- Social media sharing buttons -->
    <!-- Twitter -->
    <a href="https://twitter.com/share" class="twitter-share-button" 
       data-via="CaiusSivjus" >Tweet</a>&nbsp;

    <!-- Google+ -->
    <div class="g-plus" data-action="share" data-annotation="bubble"></div>
    &nbsp;&nbsp;&nbsp;&nbsp;
    <div class="g-plusone" data-size="medium"></div>&nbsp;

    <!-- Facebook -->
    <div class="fb-like" 
        data-href="./flask-part2-building-a-flask-web-application.html" 
        data-layout="button_count" 
        data-action="like" data-show-faces="true" 
        data-share="true">
    </div>
    &nbsp;
  </div> <!-- /Social media sharing buttons -->
  <div class="comments">
	<h2>Comments</h2>
	<div id="disqus_thread"></div>
	<script type="text/javascript">
				   (function() {
						var dsq = document.createElement('script');
						dsq.type = 'text/javascript'; dsq.async = true;
						dsq.src = '//siv-scripts.disqus.com/embed.js';
						(document.getElementsByTagName('head')[0] ||
						 document.getElementsByTagName('body')[0]).appendChild(dsq);
				  })();
	</script>
  </div>
</article>
        </div><!-- /content -->

        <div class="col-md-3 sidebar-nav" id="sidebar">

<div class="row">

<div class="col-xs-6 col-md-12">
<h4><i class="fa fa-comment fa-fw fa-lg"></i> Social</h4>
<ul class="list-unstyled social-links">
    <li><a href="http://linkedin.com/in/alysivji/" target="_blank">
	  <i class="fa fa-linkedin-square fa-fw fa-lg" title="LinkedIn"></i>
		LinkedIn
	</a></li>
    <li><a href="http://github.com/alysivji" target="_blank">
	  <i class="fa fa-github-square fa-fw fa-lg" title="GitHub"></i>
		GitHub
	</a></li>
    <li><a href="https://twitter.com/CaiusSivjus" target="_blank">
	  <i class="fa fa-twitter-square fa-fw fa-lg" title="Twitter"></i>
		Twitter
	</a></li>
</ul>
</div>

<div class="col-xs-6 col-md-12">
<h4><i class="fa fa-folder fa-fw fa-lg"></i> Categories</h4>
<ul class="list-unstyled category-links">
  <li><a href="./category/data-analysis.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Data Analysis</a></li>
  <li><a href="./category/deep-dives.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Deep Dives</a></li>
  <li><a href="./category/quick-hits.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Quick Hits</a></li>
  <li><a href="./category/thoughts.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Thoughts</a></li>
  <li><a href="./category/tutorials.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Tutorials</a></li>
</ul>
</div>

</div> <!-- /row -->

<h4><i class="fa fa-tags fa-fw fa-lg"></i> Tags</h4>
<p class="tag-cloud">
    <span class="tag-3">
      <a href="./tag/grad-school.html">
          <i class="fa fa-tag"></i>
        grad-school
      </a>
    </span>
    <span class="tag-3">
      <a href="./tag/software-engineering.html">
          <i class="fa fa-tag"></i>
        software-engineering
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/math.html">
          <i class="fa fa-tag"></i>
        math
      </a>
    </span>
    <span class="tag-3">
      <a href="./tag/flask.html">
          <i class="fa fa-tag"></i>
        flask
      </a>
    </span>
    <span class="tag-3">
      <a href="./tag/terminal.html">
          <i class="fa fa-tag"></i>
        terminal
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/art-of-developer-testing.html">
          <i class="fa fa-tag"></i>
        art-of-developer-testing
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/productivity.html">
          <i class="fa fa-tag"></i>
        productivity
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/vim.html">
          <i class="fa fa-tag"></i>
        vim
      </a>
    </span>
    <span class="tag-3">
      <a href="./tag/web-scraping.html">
          <i class="fa fa-tag"></i>
        web-scraping
      </a>
    </span>
    <span class="tag-3">
      <a href="./tag/docker.html">
          <i class="fa fa-tag"></i>
        docker
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/review.html">
          <i class="fa fa-tag"></i>
        review
      </a>
    </span>
    <span class="tag-3">
      <a href="./tag/kubernetes.html">
          <i class="fa fa-tag"></i>
        kubernetes
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/gis.html">
          <i class="fa fa-tag"></i>
        gis
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/elasticsearch.html">
          <i class="fa fa-tag"></i>
        elasticsearch
      </a>
    </span>
    <span class="tag-1">
      <a href="./tag/how-to.html">
          <i class="fa fa-tag"></i>
        how-to
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/workflow.html">
          <i class="fa fa-tag"></i>
        workflow
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/web-development.html">
          <i class="fa fa-tag"></i>
        web-development
      </a>
    </span>
    <span class="tag-1">
      <a href="./tag/python.html">
          <i class="fa fa-tag"></i>
        python
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/reddit-scraper.html">
          <i class="fa fa-tag"></i>
        reddit-scraper
      </a>
    </span>
    <span class="tag-3">
      <a href="./tag/data-viz.html">
          <i class="fa fa-tag"></i>
        data-viz
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/mac.html">
          <i class="fa fa-tag"></i>
        mac
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/cest-la-vie.html">
          <i class="fa fa-tag"></i>
        c'est-la-vie
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/exploring-pypi.html">
          <i class="fa fa-tag"></i>
        exploring-pypi
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/php.html">
          <i class="fa fa-tag"></i>
        php
      </a>
    </span>
    <span class="tag-3">
      <a href="./tag/pandas.html">
          <i class="fa fa-tag"></i>
        pandas
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/testing.html">
          <i class="fa fa-tag"></i>
        testing
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/community.html">
          <i class="fa fa-tag"></i>
        community
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/data-science.html">
          <i class="fa fa-tag"></i>
        data-science
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/pythonic.html">
          <i class="fa fa-tag"></i>
        pythonic
      </a>
    </span>
    <span class="tag-3">
      <a href="./tag/book.html">
          <i class="fa fa-tag"></i>
        book
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/mongodb.html">
          <i class="fa fa-tag"></i>
        mongodb
      </a>
    </span>
</p>
<h4><i class="fa fa-rss fa-fw fa-lg"></i> Feeds</h4>
<ul class="list-unstyled">
    <li><a href="http://alysivji.github.io/feeds/all.atom.xml" 
		   type="application/atom+xml" rel="alternate">
		<i class="fa fa-rss-square fa-fw fa-lg"></i> Atom Feed</a></li>
</ul>

<hr />

        </div><!--/sidebar -->
      </div><!--/row-->
    </div><!--/.container /#main-container -->

    <footer id="site-footer">
      <address id="site-colophon">
        <p class="text-center text-muted">
        Site built using <a href="http://getpelican.com/" target="_blank">Pelican</a>
        &nbsp;&bull;&nbsp; Theme based on
        <a href="http://www.voidynullness.net/page/voidy-bootstrap-pelican-theme/"
           target="_blank">VoidyBootstrap</a> by
        <a href="http://www.robertiwancz.com/"
           target="_blank">RKI</a>
        </p>
      </address><!-- /colophon  -->
    </footer>

<!-- DISQUS script for displaying comment count -->
<script type="text/javascript">
    var disqus_shortname = 'siv-scripts';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

    <!-- javascript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>


<!-- Facebook -->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script>

<!-- Twitter -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Google+ -->
<!-- Synchronous 
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
-->
<!-- Asynchronous -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/platform.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>  </body>
</html>