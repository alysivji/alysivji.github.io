<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="Aly Sivji" />
    <meta name="generator" content="Pelican (VoidyBootstrap theme)" />
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Premier League Analysis: Holding Steady in the League Table"/>
    <meta property="og:url" content="./pl-analysis-part1-finding-longest-consecutive-position-streak.html"/>
      <meta property="article:section" content="Data Analysis"/>
        <meta property="article:tag" content="python"/>
        <meta property="article:tag" content="pandas"/>
        <meta property="article:tag" content="data-science"/>
        <meta property="og:image"
              content="https://alysivji.github.io/images/main/siv.jpeg"/>
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Premier League Analysis: Holding Steady in the League Table">
    <meta name="twitter:description" content="">
    <meta name="twitter:site" content="@CaiusSivjus">
    <meta name="twitter:creator" content="@CaiusSivjus">
    <meta name="twitter:domain" content=".">
        <meta property="twitter:image"
              content="https://alysivji.github.io/images/main/siv.jpeg"/>

    <title>Premier League Analysis: Holding Steady in the League Table - Siv Scripts</title>

        <link rel="stylesheet"
              href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
              integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
              crossorigin="anonymous" />
      <link rel="stylesheet"
            href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
            integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
            crossorigin="anonymous">


      <link rel="stylesheet" href="./theme/css/tango.css" />
      <link rel="stylesheet" href="./theme/css/voidybootstrap.css" />
      <link rel="stylesheet" href="./theme/css/dataframe.css" />
      <link rel="stylesheet" href="./theme/css/custom.css" />

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js" integrity="sha384-FFgGfda92tXC8nCNOxrCQ3R8x1TNkMFqDZVQdDaaJiiVbjkPBXIJBx0o7ETjy8Bh" crossorigin="anonymous"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js" integrity="sha384-ZoaMbDF+4LeFxg6WdScQ9nnR1QC2MIRxA1O9KWEXQwns1G8UNyIEZIQidzb0T1fo" crossorigin="anonymous"></script>
    <![endif]-->

    <link rel="shortcut icon" href="./files/favicon.ico" />
        <link href="http://alysivji.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Siv Scripts Atom Feed" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-90986575-1', '');
  ga('send', 'pageview');

</script>
  </head>

  <body>
    <nav class="navbar navbar-default">
      <div class="container">
	   <div class="navbar-header">
		<button type="button" class="navbar-toggle"
				data-toggle="collapse" data-target="#main-navbar-collapse">
		  <span class="sr-only">Toggle navigation</span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		</button>
		<a class="navbar-brand" href="./" rel="home">
          <i class="fa fa-home fa-fw fa-lg"> </i> </a>
       </div>

      <div class="collapse navbar-collapse" id="main-navbar-collapse">
        <ul class="nav navbar-nav">
              <li>
                <a href="./pages/about.html">About</a>
              </li>
              <li>
                <a href="./pages/talks.html">Talks</a>
              </li>
            <li class="divider"></li>
            <li class="">
              <a href="./archives.html">Archives</a>
            </li>
          <li class="divider"></li>
            <li><a href="http://alysivji.github.io/feeds/all.atom.xml"
                   type="application/atom+xml" rel="alternate">
                <i class="fa fa-rss fa-fw fa-lg"></i> </a></li>
        </ul> <!-- /nav -->
      </div> <!-- /navbar-collapse -->
	  </div> <!-- /container -->
    </nav> <!-- /navbar -->

	<div class="jumbotron" id="overview">
	  <div class="container">
		<h1><a href="./">Siv Scripts</a></h1>
		<p class="lead">Solving Problems Using Code</p>
	  </div>
	</div>

    <div class="container" id="main-container">
      <div class="row">
        <div class="col-md-9" id="content">
<article itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
  <header class="article-header">
<abbr class="article-header-date">
  Thu 13 April 2017
</abbr> <h1>
  <a href="./pl-analysis-part1-finding-longest-consecutive-position-streak.html" rel="bookmark"
     title="Permalink to Premier League Analysis: Holding Steady in the League Table">
    Premier League Analysis: Holding Steady in the League Table
  </a>
</h1><div class="article-header-info">
  <p>
      Posted by <a href="./author/aly-sivji.html">Aly Sivji</a>
    in 
    <a href="./category/data-analysis.html">
      Data Analysis</a>
    &nbsp;&nbsp;
  </p>
</div> <!-- /.article-header-info -->  </header>
  <div class="content-body" itemprop="text articleBody">
	<style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><h4 id="Summary">Summary<a class="anchor-link" href="#Summary">&#182;</a></h4><ul>
<li>Gather historical Premier League data</li>
<li>Analyze results to generate standings at any given time</li>
<li>Find teams that held the same position in the league table for longer than Manchester United's 104 days in 6th place (2016-17 PL season)</li>
</ul>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One of the biggest stories of the 2016-17 Premier League season has been the <s>rise</s> <s>fall</s> stationary grace of Manchester United Football Club. United had claimed sole position of <a href="http://www.thescore.com/epl/news/1257969-manchester-united-s-104-day-residency-in-6th-place-over">6th place for 104 consecutive days</a>. This included a <a href="http://www.telegraph.co.uk/football/2017/01/26/man-utd-struggle-find-fluidity-17-match-unbeaten-run-comes-end/">17 game unbeaten streak</a> where the clubs ahead of and behind them did everything in their power to keep pace with the consistent Red Devils.</p>
<p>Unsurprisingly, the Internet has turned United's stranglehold on 6th into <a href="https://twitter.com/i/moments/830497269183086592">one of this season's spiciest memes</a>.</p>
<p>It also got me thinking: which team has the dubious distinction of holding the same position in the league table for longer than Manchester United? If you'll allow me: <em>let's not let Manchester United's 6th place reign distract us from the fact that the <a href="http://knowyourmeme.com/memes/the-warriors-blew-a-3-1-lead">Golden State Warriors blew a 3-1 lead in the NBA finals</a>.</em></p>
<p>Let's use our PyData skills and find an answer!</p>
<h3 id="Suggested-Reading">Suggested Reading<a class="anchor-link" href="#Suggested-Reading">&#182;</a></h3><p><a href="https://en.wikipedia.org/wiki/Premier_League#Competition">Wikipedia entry on the Premier League</a>.</p>
<h4 id="TL;DR">TL;DR<a class="anchor-link" href="#TL;DR">&#182;</a></h4><ul>
<li>Each team plays every other team: once at home, once away</li>
<li>Points awarded: Win=3, Draw=1, Loss=0</li>
<li>Teams are ranked by Total Points, Goal Difference, and then Goals Scored</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="What-You-Need-to-Follow-Along">What You Need to Follow Along<a class="anchor-link" href="#What-You-Need-to-Follow-Along">&#182;</a></h2><h3 id="Development-Tools-(Stack)">Development Tools (Stack)<a class="anchor-link" href="#Development-Tools-(Stack)">&#182;</a></h3><ul>
<li><a href="https://www.python.org/downloads/">Python 3.6</a> (Yes, 3.6. We will be using <a href="https://www.python.org/dev/peps/pep-0498/">f-strings</a>)</li>
<li>PyData stack (<a href="http://pandas.pydata.org/pandas-docs/stable/install.html">Pandas</a>, <a href="http://www.numpy.org/">numpy</a>)</li>
</ul>
<h3 id="Code">Code<a class="anchor-link" href="#Code">&#182;</a></h3><ul>
<li><a href="https://github.com/alysivji/blog-notebooks/blob/master/premier-league-holding-steady-league-table/pl-analysis-holding-steady-in-the-league-table.ipynb">Jupyter Notebook on Github</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Examining-the-Problem">Examining the Problem<a class="anchor-link" href="#Examining-the-Problem">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The hardest thing in Data Science is <a href="https://buckwoody.wordpress.com/2015/12/30/the-hardest-thing-in-data-science/">asking the right question</a>.</p>
<p>Let's take a closer look at our problem so we can get a sense of:</p>
<ul>
<li>the kind of data we need to gather</li>
<li>the workflow we need to follow to answer our question</li>
<li>the metrics we will use to judge success<ul>
<li>i.e. when do we consider our analysis to be complete?</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Working backwards from our desired result gives us the following workflow for our analysis:<br />
<img src="/images/01-09/6_premier_league_datastudy_workflow.png" alt="Data Study Workflow" width="660/"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Premier-League-Data-Analysis">Premier League Data Analysis<a class="anchor-link" href="#Premier-League-Data-Analysis">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Gathering-Data">Gathering Data<a class="anchor-link" href="#Gathering-Data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are a <a href="https://www.jokecamp.com/blog/guide-to-football-and-soccer-data-and-apis/">ton of data sources available</a> for us to use. For our analysis, we will be using <a href="http://www.football-data.co.uk/englandm.php">match results</a> from <a href="http://www.football-data.co.uk/englandm.php">football-data.co.uk</a>.</p>
<p>Let's <a href="http://www.football-data.co.uk/mmz4281/1617/E0.csv">download the file</a> which contains results from the 2016-17 Premier League season.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>mkdir data
<span class="o">!</span>wget -P data/ http://www.football-data.co.uk/mmz4281/1617/E0.csv
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>--2017-04-10 17:15:38--  http://www.football-data.co.uk/mmz4281/1617/E0.csv
Resolving www.football-data.co.uk... 217.160.223.109
Connecting to www.football-data.co.uk|217.160.223.109|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 82422 (80K) [text/csv]
Saving to: &#39;data/E0.csv&#39;

data/E0.csv         100%[=====================&gt;]  80.49K   290KB/s   in 0.3s   

2017-04-10 17:15:39 (290 KB/s) - &#39;data/E0.csv&#39; saved [82422/82422]

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Setting-Up-Environment">Setting Up Environment<a class="anchor-link" href="#Setting-Up-Environment">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Loading-Data">Loading Data<a class="anchor-link" href="#Loading-Data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After glancing at <a href="http://www.football-data.co.uk/notes.txt">the data notes</a> and our csv, we will load data into a pandas <code>DataFrame</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s1">&#39;data/E0.csv&#39;</span><span class="p">,</span> 
    <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">)],</span>
    <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span>
    <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[4]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Div</th>
      <th>Date</th>
      <th>HomeTeam</th>
      <th>AwayTeam</th>
      <th>FTHG</th>
      <th>FTAG</th>
      <th>FTR</th>
      <th>HTHG</th>
      <th>HTAG</th>
      <th>HTR</th>
      <th>Referee</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>E0</td>
      <td>2016-08-13</td>
      <td>Burnley</td>
      <td>Swansea</td>
      <td>0</td>
      <td>1</td>
      <td>A</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>J Moss</td>
    </tr>
    <tr>
      <th>1</th>
      <td>E0</td>
      <td>2016-08-13</td>
      <td>Crystal Palace</td>
      <td>West Brom</td>
      <td>0</td>
      <td>1</td>
      <td>A</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>C Pawson</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E0</td>
      <td>2016-08-13</td>
      <td>Everton</td>
      <td>Tottenham</td>
      <td>1</td>
      <td>1</td>
      <td>D</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>M Atkinson</td>
    </tr>
    <tr>
      <th>3</th>
      <td>E0</td>
      <td>2016-08-13</td>
      <td>Hull</td>
      <td>Leicester</td>
      <td>2</td>
      <td>1</td>
      <td>H</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>M Dean</td>
    </tr>
    <tr>
      <th>4</th>
      <td>E0</td>
      <td>2016-08-13</td>
      <td>Man City</td>
      <td>Sunderland</td>
      <td>2</td>
      <td>1</td>
      <td>H</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>R Madley</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Wrangling-Data">Wrangling Data<a class="anchor-link" href="#Wrangling-Data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As previously mentioned, we are using a match results dataset to conduct our analysis. Each row in this <code>DataFrame</code> represents a single match result. Leaving data in this format will make it difficult to write <a href="https://tomaugspurger.github.io/modern-1.html">idiomatic pandas expressions</a> to slice-and-dice our <code>DataFrame</code> later on.</p>
<p><strong>Why?</strong> Going back to our workflow diagram, we require a function to calculate the league table at the end of each day. In its current format, we would need to iterate over our data a total of 2 times: once to calculate results when <code>current_team == HomeTeam</code> and, the second time, when <code>current_team == AwayTeam</code>.</p>
<p>A better data structure would have each row in our <code>DataFrame</code> represent a result for each team, regardless of whether they are playing home or away. We can use the <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.melt.html"><code>pandas.melt()</code> function</a> to transform our data as follows:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">## converting each matchup into 2 rows</span>
<span class="c1">## one where each team is &#39;current_team&#39; and opponent is identfied</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;HomeTeam&#39;</span><span class="p">]</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;AwayTeam&#39;</span><span class="p">]</span>
<span class="n">cols_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Div&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;HomeTeam&#39;</span><span class="p">,</span> <span class="s1">&#39;AwayTeam&#39;</span><span class="p">,</span> <span class="s1">&#39;FTHG&#39;</span><span class="p">,</span>
                <span class="s1">&#39;FTAG&#39;</span><span class="p">,</span> <span class="s1">&#39;FTR&#39;</span><span class="p">,</span> <span class="s1">&#39;HTHG&#39;</span><span class="p">,</span> <span class="s1">&#39;HTAG&#39;</span><span class="p">,</span> <span class="s1">&#39;HTR&#39;</span><span class="p">,</span> <span class="s1">&#39;Referee&#39;</span><span class="p">]</span>

<span class="n">team_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">results</span><span class="p">,</span> 
    <span class="n">id_vars</span><span class="o">=</span><span class="n">cols_to_keep</span><span class="p">,</span> 
    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;Home/Away&#39;</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Team&#39;</span><span class="p">)</span>

<span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Opponent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Team&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;HomeTeam&#39;</span><span class="p">],</span>
                                    <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;AwayTeam&#39;</span><span class="p">],</span>
                                    <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;HomeTeam&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">team_results</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[6]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Div</th>
      <th>Date</th>
      <th>HomeTeam</th>
      <th>AwayTeam</th>
      <th>FTHG</th>
      <th>FTAG</th>
      <th>FTR</th>
      <th>HTHG</th>
      <th>HTAG</th>
      <th>HTR</th>
      <th>Referee</th>
      <th>Home/Away</th>
      <th>Team</th>
      <th>Opponent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>E0</td>
      <td>2016-08-13</td>
      <td>Burnley</td>
      <td>Swansea</td>
      <td>0</td>
      <td>1</td>
      <td>A</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>J Moss</td>
      <td>H</td>
      <td>Burnley</td>
      <td>Swansea</td>
    </tr>
    <tr>
      <th>1</th>
      <td>E0</td>
      <td>2016-08-13</td>
      <td>Crystal Palace</td>
      <td>West Brom</td>
      <td>0</td>
      <td>1</td>
      <td>A</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>C Pawson</td>
      <td>H</td>
      <td>Crystal Palace</td>
      <td>West Brom</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We need to transform 'home' and 'away' goals to goals scored for each team and then calculate a result given the combined score. This is also a good spot to calculate how many points the team was awarded for the match result.</p>
<p>We will use <a href="http://stackoverflow.com/questions/19914937/applying-function-with-multiple-arguments-to-create-a-new-pandas-column">this post from StackOverflow</a> <em>(Praise Be)</em> as a guide and proceed as follows:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">points_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;W&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">get_result</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="n">score_opp</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="n">score_opp</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;D&#39;</span>
    <span class="k">elif</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="n">score_opp</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;W&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;L&#39;</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># full time goals</span>
<span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Goals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Team&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;HomeTeam&#39;</span><span class="p">],</span>
                                 <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;FTHG&#39;</span><span class="p">],</span>
                                 <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;FTAG&#39;</span><span class="p">])</span>
<span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Goals_Opp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Team&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;HomeTeam&#39;</span><span class="p">],</span>
                                     <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;FTHG&#39;</span><span class="p">],</span>
                                     <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;FTAG&#39;</span><span class="p">])</span>
<span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Result&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">get_result</span><span class="p">)(</span><span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Goals&#39;</span><span class="p">],</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Goals_Opp&#39;</span><span class="p">])</span>
<span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Result&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">points_map</span><span class="p">)</span>

<span class="c1"># 1st half goals</span>
<span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;1H_Goals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Team&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;HomeTeam&#39;</span><span class="p">],</span>
                                    <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;HTHG&#39;</span><span class="p">],</span>
                                    <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;HTAG&#39;</span><span class="p">])</span>
<span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;1H_Goals_Opp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Team&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;HomeTeam&#39;</span><span class="p">],</span>
                                        <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;HTHG&#39;</span><span class="p">],</span>
                                        <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;HTAG&#39;</span><span class="p">])</span>
<span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;1H_Result&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">get_result</span><span class="p">)(</span><span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;1H_Goals&#39;</span><span class="p">],</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;1H_Goals_Opp&#39;</span><span class="p">])</span>
<span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;1H_Points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;1H_Result&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">points_map</span><span class="p">)</span>

<span class="c1"># 2nd half goals</span>
<span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;2H_Goals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Goals&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;1H_Goals&#39;</span><span class="p">]</span>
<span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;2H_Goals_Opp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Goals_Opp&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;1H_Goals_Opp&#39;</span><span class="p">]</span>
<span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;2H_Result&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">get_result</span><span class="p">)(</span><span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;2H_Goals&#39;</span><span class="p">],</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;2H_Goals_Opp&#39;</span><span class="p">])</span>
<span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;2H_Points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;2H_Result&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">points_map</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Drop unnecessary columns and sort by date</span>
<span class="n">cols_to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HomeTeam&#39;</span><span class="p">,</span> <span class="s1">&#39;AwayTeam&#39;</span><span class="p">,</span> <span class="s1">&#39;FTHG&#39;</span><span class="p">,</span> <span class="s1">&#39;FTAG&#39;</span><span class="p">,</span> <span class="s1">&#39;FTR&#39;</span><span class="p">,</span> <span class="s1">&#39;HTHG&#39;</span><span class="p">,</span> <span class="s1">&#39;HTAG&#39;</span><span class="p">,</span> <span class="s1">&#39;HTR&#39;</span><span class="p">]</span>
<span class="n">team_results</span> <span class="o">=</span> <span class="p">(</span><span class="n">team_results</span>
                    <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">cols_to_drop</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Referee&#39;</span><span class="p">]))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">team_results</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[10]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Div</th>
      <th>Date</th>
      <th>Referee</th>
      <th>Home/Away</th>
      <th>Team</th>
      <th>Opponent</th>
      <th>Goals</th>
      <th>Goals_Opp</th>
      <th>Result</th>
      <th>Points</th>
      <th>1H_Goals</th>
      <th>1H_Goals_Opp</th>
      <th>1H_Result</th>
      <th>1H_Points</th>
      <th>2H_Goals</th>
      <th>2H_Goals_Opp</th>
      <th>2H_Result</th>
      <th>2H_Points</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>E0</td>
      <td>2016-08-13</td>
      <td>C Pawson</td>
      <td>H</td>
      <td>Crystal Palace</td>
      <td>West Brom</td>
      <td>0</td>
      <td>1</td>
      <td>L</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>L</td>
      <td>0</td>
    </tr>
    <tr>
      <th>314</th>
      <td>E0</td>
      <td>2016-08-13</td>
      <td>C Pawson</td>
      <td>A</td>
      <td>West Brom</td>
      <td>Crystal Palace</td>
      <td>1</td>
      <td>0</td>
      <td>W</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>W</td>
      <td>3</td>
    </tr>
    <tr>
      <th>0</th>
      <td>E0</td>
      <td>2016-08-13</td>
      <td>J Moss</td>
      <td>H</td>
      <td>Burnley</td>
      <td>Swansea</td>
      <td>0</td>
      <td>1</td>
      <td>L</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>L</td>
      <td>0</td>
    </tr>
    <tr>
      <th>313</th>
      <td>E0</td>
      <td>2016-08-13</td>
      <td>J Moss</td>
      <td>A</td>
      <td>Swansea</td>
      <td>Burnley</td>
      <td>1</td>
      <td>0</td>
      <td>W</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>W</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>E0</td>
      <td>2016-08-13</td>
      <td>K Friend</td>
      <td>H</td>
      <td>Middlesbrough</td>
      <td>Stoke</td>
      <td>1</td>
      <td>1</td>
      <td>D</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>W</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>L</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Calculating-League-Table-(Standings-Table)">Calculating League Table (Standings Table)<a class="anchor-link" href="#Calculating-League-Table-(Standings-Table)">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Testing the standings function against real world data</span>
<span class="p">(</span><span class="n">team_results</span>
     <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Team&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">sum</span><span class="p">()[</span><span class="s1">&#39;Points&#39;</span><span class="p">]</span>
     <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Team
Chelsea           75
Tottenham         68
Liverpool         63
Man City          61
Man United        57
Everton           54
Arsenal           54
West Brom         44
Southampton       40
Watford           37
Stoke             36
Leicester         36
Burnley           36
West Ham          36
Bournemouth       35
Crystal Palace    34
Hull              30
Swansea           28
Middlesbrough     24
Sunderland        20
Name: Points, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This matches the current table (as of April 10 2017)<br />
<img src="/images/01-09/6_premier_league_table_20170410.png" alt="Data Study Workflow" width="550/"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">standings</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">result_col</span><span class="p">,</span> <span class="n">goals_col</span><span class="p">,</span> <span class="n">goals_opp_col</span><span class="p">,</span> <span class="n">points_col</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function takes in a DataFrame and strings identifying fields</span>
<span class="sd">    to calculate the league table.</span>
<span class="sd">    </span>
<span class="sd">    Making it generalized will allow us to calculate league tables for</span>
<span class="sd">    First Half Goals only. Second Half Goals only.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">record</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="n">record</span><span class="p">[</span><span class="s1">&#39;Played&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">result_col</span><span class="p">])</span>
    <span class="n">record</span><span class="p">[</span><span class="s1">&#39;Won&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">result_col</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;W&#39;</span><span class="p">)</span>
    <span class="n">record</span><span class="p">[</span><span class="s1">&#39;Drawn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">result_col</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
    <span class="n">record</span><span class="p">[</span><span class="s1">&#39;Lost&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">result_col</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">)</span>
    <span class="n">record</span><span class="p">[</span><span class="s1">&#39;GF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">goals_col</span><span class="p">])</span>
    <span class="n">record</span><span class="p">[</span><span class="s1">&#39;GA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">goals_opp_col</span><span class="p">])</span>
    <span class="n">record</span><span class="p">[</span><span class="s1">&#39;GD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s1">&#39;GF&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">record</span><span class="p">[</span><span class="s1">&#39;GA&#39;</span><span class="p">]</span>
    <span class="n">record</span><span class="p">[</span><span class="s1">&#39;Points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">points_col</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">record</span><span class="p">,</span>
                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Played&#39;</span><span class="p">,</span> <span class="s1">&#39;Won&#39;</span><span class="p">,</span> <span class="s1">&#39;Drawn&#39;</span><span class="p">,</span> <span class="s1">&#39;Lost&#39;</span><span class="p">,</span> <span class="s1">&#39;GF&#39;</span><span class="p">,</span> <span class="s1">&#39;GA&#39;</span><span class="p">,</span> <span class="s1">&#39;GD&#39;</span><span class="p">,</span> <span class="s2">&quot;Points&quot;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get League Table</span>
<span class="n">results_byteam</span> <span class="o">=</span> <span class="n">team_results</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Team&#39;</span><span class="p">])</span>

<span class="p">(</span><span class="n">results_byteam</span> 
     <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">standings</span><span class="p">,</span>
            <span class="n">result_col</span><span class="o">=</span><span class="s1">&#39;Result&#39;</span><span class="p">,</span>
            <span class="n">goals_col</span><span class="o">=</span><span class="s1">&#39;Goals&#39;</span><span class="p">,</span>
            <span class="n">goals_opp_col</span><span class="o">=</span><span class="s1">&#39;Goals_Opp&#39;</span><span class="p">,</span>
            <span class="n">points_col</span><span class="o">=</span><span class="s1">&#39;Points&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Points&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[13]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Played</th>
      <th>Won</th>
      <th>Drawn</th>
      <th>Lost</th>
      <th>GF</th>
      <th>GA</th>
      <th>GD</th>
      <th>Points</th>
    </tr>
    <tr>
      <th>Team</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Chelsea</th>
      <td>31</td>
      <td>24</td>
      <td>3</td>
      <td>4</td>
      <td>65</td>
      <td>25</td>
      <td>40</td>
      <td>75</td>
    </tr>
    <tr>
      <th>Tottenham</th>
      <td>31</td>
      <td>20</td>
      <td>8</td>
      <td>3</td>
      <td>64</td>
      <td>22</td>
      <td>42</td>
      <td>68</td>
    </tr>
    <tr>
      <th>Liverpool</th>
      <td>32</td>
      <td>18</td>
      <td>9</td>
      <td>5</td>
      <td>68</td>
      <td>40</td>
      <td>28</td>
      <td>63</td>
    </tr>
    <tr>
      <th>Man City</th>
      <td>31</td>
      <td>18</td>
      <td>7</td>
      <td>6</td>
      <td>60</td>
      <td>35</td>
      <td>25</td>
      <td>61</td>
    </tr>
    <tr>
      <th>Man United</th>
      <td>30</td>
      <td>15</td>
      <td>12</td>
      <td>3</td>
      <td>46</td>
      <td>24</td>
      <td>22</td>
      <td>57</td>
    </tr>
    <tr>
      <th>Arsenal</th>
      <td>30</td>
      <td>16</td>
      <td>6</td>
      <td>8</td>
      <td>61</td>
      <td>39</td>
      <td>22</td>
      <td>54</td>
    </tr>
    <tr>
      <th>Everton</th>
      <td>32</td>
      <td>15</td>
      <td>9</td>
      <td>8</td>
      <td>57</td>
      <td>36</td>
      <td>21</td>
      <td>54</td>
    </tr>
    <tr>
      <th>West Brom</th>
      <td>32</td>
      <td>12</td>
      <td>8</td>
      <td>12</td>
      <td>39</td>
      <td>41</td>
      <td>-2</td>
      <td>44</td>
    </tr>
    <tr>
      <th>Southampton</th>
      <td>30</td>
      <td>11</td>
      <td>7</td>
      <td>12</td>
      <td>37</td>
      <td>37</td>
      <td>0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>Watford</th>
      <td>31</td>
      <td>10</td>
      <td>7</td>
      <td>14</td>
      <td>36</td>
      <td>52</td>
      <td>-16</td>
      <td>37</td>
    </tr>
    <tr>
      <th>Leicester</th>
      <td>31</td>
      <td>10</td>
      <td>6</td>
      <td>15</td>
      <td>39</td>
      <td>51</td>
      <td>-12</td>
      <td>36</td>
    </tr>
    <tr>
      <th>Stoke</th>
      <td>32</td>
      <td>9</td>
      <td>9</td>
      <td>14</td>
      <td>34</td>
      <td>47</td>
      <td>-13</td>
      <td>36</td>
    </tr>
    <tr>
      <th>Burnley</th>
      <td>32</td>
      <td>10</td>
      <td>6</td>
      <td>16</td>
      <td>32</td>
      <td>44</td>
      <td>-12</td>
      <td>36</td>
    </tr>
    <tr>
      <th>West Ham</th>
      <td>32</td>
      <td>10</td>
      <td>6</td>
      <td>16</td>
      <td>42</td>
      <td>57</td>
      <td>-15</td>
      <td>36</td>
    </tr>
    <tr>
      <th>Bournemouth</th>
      <td>32</td>
      <td>9</td>
      <td>8</td>
      <td>15</td>
      <td>45</td>
      <td>59</td>
      <td>-14</td>
      <td>35</td>
    </tr>
    <tr>
      <th>Crystal Palace</th>
      <td>31</td>
      <td>10</td>
      <td>4</td>
      <td>17</td>
      <td>42</td>
      <td>50</td>
      <td>-8</td>
      <td>34</td>
    </tr>
    <tr>
      <th>Hull</th>
      <td>32</td>
      <td>8</td>
      <td>6</td>
      <td>18</td>
      <td>33</td>
      <td>64</td>
      <td>-31</td>
      <td>30</td>
    </tr>
    <tr>
      <th>Swansea</th>
      <td>32</td>
      <td>8</td>
      <td>4</td>
      <td>20</td>
      <td>37</td>
      <td>67</td>
      <td>-30</td>
      <td>28</td>
    </tr>
    <tr>
      <th>Middlesbrough</th>
      <td>31</td>
      <td>4</td>
      <td>12</td>
      <td>15</td>
      <td>22</td>
      <td>37</td>
      <td>-15</td>
      <td>24</td>
    </tr>
    <tr>
      <th>Sunderland</th>
      <td>31</td>
      <td>5</td>
      <td>5</td>
      <td>21</td>
      <td>24</td>
      <td>56</td>
      <td>-32</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get League Table for First Half Goals only</span>
<span class="p">(</span><span class="n">results_byteam</span>
     <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">standings</span><span class="p">,</span>
            <span class="n">result_col</span><span class="o">=</span><span class="s1">&#39;Result&#39;</span><span class="p">,</span>
            <span class="n">goals_col</span><span class="o">=</span><span class="s1">&#39;Goals&#39;</span><span class="p">,</span>
            <span class="n">goals_opp_col</span><span class="o">=</span><span class="s1">&#39;Goals_Opp&#39;</span><span class="p">,</span>
            <span class="n">points_col</span><span class="o">=</span><span class="s1">&#39;Points&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Points&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[14]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Played</th>
      <th>Won</th>
      <th>Drawn</th>
      <th>Lost</th>
      <th>GF</th>
      <th>GA</th>
      <th>GD</th>
      <th>Points</th>
    </tr>
    <tr>
      <th>Team</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Chelsea</th>
      <td>31</td>
      <td>24</td>
      <td>3</td>
      <td>4</td>
      <td>65</td>
      <td>25</td>
      <td>40</td>
      <td>75</td>
    </tr>
    <tr>
      <th>Tottenham</th>
      <td>31</td>
      <td>20</td>
      <td>8</td>
      <td>3</td>
      <td>64</td>
      <td>22</td>
      <td>42</td>
      <td>68</td>
    </tr>
    <tr>
      <th>Liverpool</th>
      <td>32</td>
      <td>18</td>
      <td>9</td>
      <td>5</td>
      <td>68</td>
      <td>40</td>
      <td>28</td>
      <td>63</td>
    </tr>
    <tr>
      <th>Man City</th>
      <td>31</td>
      <td>18</td>
      <td>7</td>
      <td>6</td>
      <td>60</td>
      <td>35</td>
      <td>25</td>
      <td>61</td>
    </tr>
    <tr>
      <th>Man United</th>
      <td>30</td>
      <td>15</td>
      <td>12</td>
      <td>3</td>
      <td>46</td>
      <td>24</td>
      <td>22</td>
      <td>57</td>
    </tr>
    <tr>
      <th>Arsenal</th>
      <td>30</td>
      <td>16</td>
      <td>6</td>
      <td>8</td>
      <td>61</td>
      <td>39</td>
      <td>22</td>
      <td>54</td>
    </tr>
    <tr>
      <th>Everton</th>
      <td>32</td>
      <td>15</td>
      <td>9</td>
      <td>8</td>
      <td>57</td>
      <td>36</td>
      <td>21</td>
      <td>54</td>
    </tr>
    <tr>
      <th>West Brom</th>
      <td>32</td>
      <td>12</td>
      <td>8</td>
      <td>12</td>
      <td>39</td>
      <td>41</td>
      <td>-2</td>
      <td>44</td>
    </tr>
    <tr>
      <th>Southampton</th>
      <td>30</td>
      <td>11</td>
      <td>7</td>
      <td>12</td>
      <td>37</td>
      <td>37</td>
      <td>0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>Watford</th>
      <td>31</td>
      <td>10</td>
      <td>7</td>
      <td>14</td>
      <td>36</td>
      <td>52</td>
      <td>-16</td>
      <td>37</td>
    </tr>
    <tr>
      <th>Leicester</th>
      <td>31</td>
      <td>10</td>
      <td>6</td>
      <td>15</td>
      <td>39</td>
      <td>51</td>
      <td>-12</td>
      <td>36</td>
    </tr>
    <tr>
      <th>Stoke</th>
      <td>32</td>
      <td>9</td>
      <td>9</td>
      <td>14</td>
      <td>34</td>
      <td>47</td>
      <td>-13</td>
      <td>36</td>
    </tr>
    <tr>
      <th>Burnley</th>
      <td>32</td>
      <td>10</td>
      <td>6</td>
      <td>16</td>
      <td>32</td>
      <td>44</td>
      <td>-12</td>
      <td>36</td>
    </tr>
    <tr>
      <th>West Ham</th>
      <td>32</td>
      <td>10</td>
      <td>6</td>
      <td>16</td>
      <td>42</td>
      <td>57</td>
      <td>-15</td>
      <td>36</td>
    </tr>
    <tr>
      <th>Bournemouth</th>
      <td>32</td>
      <td>9</td>
      <td>8</td>
      <td>15</td>
      <td>45</td>
      <td>59</td>
      <td>-14</td>
      <td>35</td>
    </tr>
    <tr>
      <th>Crystal Palace</th>
      <td>31</td>
      <td>10</td>
      <td>4</td>
      <td>17</td>
      <td>42</td>
      <td>50</td>
      <td>-8</td>
      <td>34</td>
    </tr>
    <tr>
      <th>Hull</th>
      <td>32</td>
      <td>8</td>
      <td>6</td>
      <td>18</td>
      <td>33</td>
      <td>64</td>
      <td>-31</td>
      <td>30</td>
    </tr>
    <tr>
      <th>Swansea</th>
      <td>32</td>
      <td>8</td>
      <td>4</td>
      <td>20</td>
      <td>37</td>
      <td>67</td>
      <td>-30</td>
      <td>28</td>
    </tr>
    <tr>
      <th>Middlesbrough</th>
      <td>31</td>
      <td>4</td>
      <td>12</td>
      <td>15</td>
      <td>22</td>
      <td>37</td>
      <td>-15</td>
      <td>24</td>
    </tr>
    <tr>
      <th>Sunderland</th>
      <td>31</td>
      <td>5</td>
      <td>5</td>
      <td>21</td>
      <td>24</td>
      <td>56</td>
      <td>-32</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get League Table for Second Half Goals only</span>
<span class="p">(</span><span class="n">results_byteam</span>
     <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">standings</span><span class="p">,</span>
            <span class="n">result_col</span><span class="o">=</span><span class="s1">&#39;Result&#39;</span><span class="p">,</span>
            <span class="n">goals_col</span><span class="o">=</span><span class="s1">&#39;Goals&#39;</span><span class="p">,</span>
            <span class="n">goals_opp_col</span><span class="o">=</span><span class="s1">&#39;Goals_Opp&#39;</span><span class="p">,</span>
            <span class="n">points_col</span><span class="o">=</span><span class="s1">&#39;Points&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Points&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[15]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Played</th>
      <th>Won</th>
      <th>Drawn</th>
      <th>Lost</th>
      <th>GF</th>
      <th>GA</th>
      <th>GD</th>
      <th>Points</th>
    </tr>
    <tr>
      <th>Team</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Chelsea</th>
      <td>31</td>
      <td>24</td>
      <td>3</td>
      <td>4</td>
      <td>65</td>
      <td>25</td>
      <td>40</td>
      <td>75</td>
    </tr>
    <tr>
      <th>Tottenham</th>
      <td>31</td>
      <td>20</td>
      <td>8</td>
      <td>3</td>
      <td>64</td>
      <td>22</td>
      <td>42</td>
      <td>68</td>
    </tr>
    <tr>
      <th>Liverpool</th>
      <td>32</td>
      <td>18</td>
      <td>9</td>
      <td>5</td>
      <td>68</td>
      <td>40</td>
      <td>28</td>
      <td>63</td>
    </tr>
    <tr>
      <th>Man City</th>
      <td>31</td>
      <td>18</td>
      <td>7</td>
      <td>6</td>
      <td>60</td>
      <td>35</td>
      <td>25</td>
      <td>61</td>
    </tr>
    <tr>
      <th>Man United</th>
      <td>30</td>
      <td>15</td>
      <td>12</td>
      <td>3</td>
      <td>46</td>
      <td>24</td>
      <td>22</td>
      <td>57</td>
    </tr>
    <tr>
      <th>Arsenal</th>
      <td>30</td>
      <td>16</td>
      <td>6</td>
      <td>8</td>
      <td>61</td>
      <td>39</td>
      <td>22</td>
      <td>54</td>
    </tr>
    <tr>
      <th>Everton</th>
      <td>32</td>
      <td>15</td>
      <td>9</td>
      <td>8</td>
      <td>57</td>
      <td>36</td>
      <td>21</td>
      <td>54</td>
    </tr>
    <tr>
      <th>West Brom</th>
      <td>32</td>
      <td>12</td>
      <td>8</td>
      <td>12</td>
      <td>39</td>
      <td>41</td>
      <td>-2</td>
      <td>44</td>
    </tr>
    <tr>
      <th>Southampton</th>
      <td>30</td>
      <td>11</td>
      <td>7</td>
      <td>12</td>
      <td>37</td>
      <td>37</td>
      <td>0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>Watford</th>
      <td>31</td>
      <td>10</td>
      <td>7</td>
      <td>14</td>
      <td>36</td>
      <td>52</td>
      <td>-16</td>
      <td>37</td>
    </tr>
    <tr>
      <th>Leicester</th>
      <td>31</td>
      <td>10</td>
      <td>6</td>
      <td>15</td>
      <td>39</td>
      <td>51</td>
      <td>-12</td>
      <td>36</td>
    </tr>
    <tr>
      <th>Stoke</th>
      <td>32</td>
      <td>9</td>
      <td>9</td>
      <td>14</td>
      <td>34</td>
      <td>47</td>
      <td>-13</td>
      <td>36</td>
    </tr>
    <tr>
      <th>Burnley</th>
      <td>32</td>
      <td>10</td>
      <td>6</td>
      <td>16</td>
      <td>32</td>
      <td>44</td>
      <td>-12</td>
      <td>36</td>
    </tr>
    <tr>
      <th>West Ham</th>
      <td>32</td>
      <td>10</td>
      <td>6</td>
      <td>16</td>
      <td>42</td>
      <td>57</td>
      <td>-15</td>
      <td>36</td>
    </tr>
    <tr>
      <th>Bournemouth</th>
      <td>32</td>
      <td>9</td>
      <td>8</td>
      <td>15</td>
      <td>45</td>
      <td>59</td>
      <td>-14</td>
      <td>35</td>
    </tr>
    <tr>
      <th>Crystal Palace</th>
      <td>31</td>
      <td>10</td>
      <td>4</td>
      <td>17</td>
      <td>42</td>
      <td>50</td>
      <td>-8</td>
      <td>34</td>
    </tr>
    <tr>
      <th>Hull</th>
      <td>32</td>
      <td>8</td>
      <td>6</td>
      <td>18</td>
      <td>33</td>
      <td>64</td>
      <td>-31</td>
      <td>30</td>
    </tr>
    <tr>
      <th>Swansea</th>
      <td>32</td>
      <td>8</td>
      <td>4</td>
      <td>20</td>
      <td>37</td>
      <td>67</td>
      <td>-30</td>
      <td>28</td>
    </tr>
    <tr>
      <th>Middlesbrough</th>
      <td>31</td>
      <td>4</td>
      <td>12</td>
      <td>15</td>
      <td>22</td>
      <td>37</td>
      <td>-15</td>
      <td>24</td>
    </tr>
    <tr>
      <th>Sunderland</th>
      <td>31</td>
      <td>5</td>
      <td>5</td>
      <td>21</td>
      <td>24</td>
      <td>56</td>
      <td>-32</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Ranking-Teams">Ranking Teams<a class="anchor-link" href="#Ranking-Teams">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can use the <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.rank.html"><code>DataFrame.rank()</code> method</a> to rank each team based on Premier League tiebreaks (Total Points -&gt; Goal Difference -&gt; Goals Scored).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Rank Teams in Standings</span>
<span class="n">league_table</span> <span class="o">=</span> <span class="p">(</span><span class="n">results_byteam</span>
                    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">standings</span><span class="p">,</span>
                           <span class="n">result_col</span><span class="o">=</span><span class="s1">&#39;Result&#39;</span><span class="p">,</span>
                           <span class="n">goals_col</span><span class="o">=</span><span class="s1">&#39;Goals&#39;</span><span class="p">,</span>
                           <span class="n">goals_opp_col</span><span class="o">=</span><span class="s1">&#39;Goals_Opp&#39;</span><span class="p">,</span>
                           <span class="n">points_col</span><span class="o">=</span><span class="s1">&#39;Points&#39;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Points&#39;</span><span class="p">,</span> <span class="s1">&#39;GD&#39;</span><span class="p">,</span> <span class="s1">&#39;GF&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">league_table</span><span class="p">[</span><span class="s1">&#39;rank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">league_table</span>
                            <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Points&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;GD&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;GF&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                            <span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="n">league_table</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[17]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Played</th>
      <th>Won</th>
      <th>Drawn</th>
      <th>Lost</th>
      <th>GF</th>
      <th>GA</th>
      <th>GD</th>
      <th>Points</th>
      <th>rank</th>
    </tr>
    <tr>
      <th>Team</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Chelsea</th>
      <td>31</td>
      <td>24</td>
      <td>3</td>
      <td>4</td>
      <td>65</td>
      <td>25</td>
      <td>40</td>
      <td>75</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Tottenham</th>
      <td>31</td>
      <td>20</td>
      <td>8</td>
      <td>3</td>
      <td>64</td>
      <td>22</td>
      <td>42</td>
      <td>68</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Liverpool</th>
      <td>32</td>
      <td>18</td>
      <td>9</td>
      <td>5</td>
      <td>68</td>
      <td>40</td>
      <td>28</td>
      <td>63</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Man City</th>
      <td>31</td>
      <td>18</td>
      <td>7</td>
      <td>6</td>
      <td>60</td>
      <td>35</td>
      <td>25</td>
      <td>61</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Man United</th>
      <td>30</td>
      <td>15</td>
      <td>12</td>
      <td>3</td>
      <td>46</td>
      <td>24</td>
      <td>22</td>
      <td>57</td>
      <td>5</td>
    </tr>
    <tr>
      <th>Arsenal</th>
      <td>30</td>
      <td>16</td>
      <td>6</td>
      <td>8</td>
      <td>61</td>
      <td>39</td>
      <td>22</td>
      <td>54</td>
      <td>6</td>
    </tr>
    <tr>
      <th>Everton</th>
      <td>32</td>
      <td>15</td>
      <td>9</td>
      <td>8</td>
      <td>57</td>
      <td>36</td>
      <td>21</td>
      <td>54</td>
      <td>7</td>
    </tr>
    <tr>
      <th>West Brom</th>
      <td>32</td>
      <td>12</td>
      <td>8</td>
      <td>12</td>
      <td>39</td>
      <td>41</td>
      <td>-2</td>
      <td>44</td>
      <td>8</td>
    </tr>
    <tr>
      <th>Southampton</th>
      <td>30</td>
      <td>11</td>
      <td>7</td>
      <td>12</td>
      <td>37</td>
      <td>37</td>
      <td>0</td>
      <td>40</td>
      <td>9</td>
    </tr>
    <tr>
      <th>Watford</th>
      <td>31</td>
      <td>10</td>
      <td>7</td>
      <td>14</td>
      <td>36</td>
      <td>52</td>
      <td>-16</td>
      <td>37</td>
      <td>10</td>
    </tr>
    <tr>
      <th>Leicester</th>
      <td>31</td>
      <td>10</td>
      <td>6</td>
      <td>15</td>
      <td>39</td>
      <td>51</td>
      <td>-12</td>
      <td>36</td>
      <td>11</td>
    </tr>
    <tr>
      <th>Burnley</th>
      <td>32</td>
      <td>10</td>
      <td>6</td>
      <td>16</td>
      <td>32</td>
      <td>44</td>
      <td>-12</td>
      <td>36</td>
      <td>12</td>
    </tr>
    <tr>
      <th>Stoke</th>
      <td>32</td>
      <td>9</td>
      <td>9</td>
      <td>14</td>
      <td>34</td>
      <td>47</td>
      <td>-13</td>
      <td>36</td>
      <td>13</td>
    </tr>
    <tr>
      <th>West Ham</th>
      <td>32</td>
      <td>10</td>
      <td>6</td>
      <td>16</td>
      <td>42</td>
      <td>57</td>
      <td>-15</td>
      <td>36</td>
      <td>14</td>
    </tr>
    <tr>
      <th>Bournemouth</th>
      <td>32</td>
      <td>9</td>
      <td>8</td>
      <td>15</td>
      <td>45</td>
      <td>59</td>
      <td>-14</td>
      <td>35</td>
      <td>15</td>
    </tr>
    <tr>
      <th>Crystal Palace</th>
      <td>31</td>
      <td>10</td>
      <td>4</td>
      <td>17</td>
      <td>42</td>
      <td>50</td>
      <td>-8</td>
      <td>34</td>
      <td>16</td>
    </tr>
    <tr>
      <th>Hull</th>
      <td>32</td>
      <td>8</td>
      <td>6</td>
      <td>18</td>
      <td>33</td>
      <td>64</td>
      <td>-31</td>
      <td>30</td>
      <td>17</td>
    </tr>
    <tr>
      <th>Swansea</th>
      <td>32</td>
      <td>8</td>
      <td>4</td>
      <td>20</td>
      <td>37</td>
      <td>67</td>
      <td>-30</td>
      <td>28</td>
      <td>18</td>
    </tr>
    <tr>
      <th>Middlesbrough</th>
      <td>31</td>
      <td>4</td>
      <td>12</td>
      <td>15</td>
      <td>22</td>
      <td>37</td>
      <td>-15</td>
      <td>24</td>
      <td>19</td>
    </tr>
    <tr>
      <th>Sunderland</th>
      <td>31</td>
      <td>5</td>
      <td>5</td>
      <td>21</td>
      <td>24</td>
      <td>56</td>
      <td>-32</td>
      <td>20</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Fantastic! This is the exact ranking we see online!<br />
<img src="/images/01-09/6_premier_league_table_20170410.png" alt="Data Study Workflow" width="550/"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is great, but there is one problem. How do we rank teams at the start of the season when some have played a game while others have not?</p>
<p>The <code>pandas.rank()</code> function will work most of the time, except for the edge case where not every team has completed their first game. We will need to take this into account when create our custom <code>rank_teams()</code> function.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">rank_teams</span><span class="p">(</span><span class="n">league_table</span><span class="p">,</span> <span class="n">team_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a Series of ranked teams, including those who have yet to play</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        * league_table - League Table DataFrame</span>
<span class="sd">        * team_list - List of all teams in league</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># sort by tiebraker and rank</span>
    <span class="n">team_rank</span> <span class="o">=</span> <span class="p">(</span><span class="n">league_table</span>
                     <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Points&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;GD&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;GF&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                     <span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                     <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
    
    <span class="c1"># if not all teams are ranked (i.e. some of them might have not have played yet)</span>
    <span class="k">if</span> <span class="n">team_rank</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">team_list</span><span class="p">):</span>
        <span class="c1"># get all teams that need to be added to the table</span>
        <span class="n">ranked_teams</span> <span class="o">=</span> <span class="n">team_rank</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
        <span class="n">teams_to_add</span> <span class="o">=</span> <span class="p">{</span><span class="n">team</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">team_list</span> <span class="k">if</span> <span class="n">team</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ranked_teams</span><span class="p">}</span>  
        
        <span class="c1"># position to rank remaining teams</span>
        <span class="n">rank_to_assign</span> <span class="o">=</span> <span class="n">team_rank</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">1</span>
        
        <span class="c1"># add teams that haven&#39;t played a game to rankings</span>
        <span class="n">team_pos</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">teams_to_add</span><span class="p">:</span>
            <span class="n">team_pos</span><span class="p">[</span><span class="n">team</span><span class="p">]</span> <span class="o">=</span> <span class="n">rank_to_assign</span>
        <span class="n">team_rank</span> <span class="o">=</span> <span class="n">team_rank</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">team_pos</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">team_rank</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Let&#39;s test our function to make sure it works</span>
<span class="n">all_teams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Team&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">rank_teams</span><span class="p">(</span><span class="n">league_table</span><span class="p">,</span> <span class="n">team_list</span><span class="o">=</span><span class="n">all_teams</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[19]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Team
Chelsea            1
Tottenham          2
Liverpool          3
Man City           4
Man United         5
Arsenal            6
Everton            7
West Brom          8
Southampton        9
Watford           10
Leicester         11
Burnley           12
Stoke             13
West Ham          14
Bournemouth       15
Crystal Palace    16
Hull              17
Swansea           18
Middlesbrough     19
Sunderland        20
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Tracking-Team-Rankings-Across-Entire-Season">Tracking Team Rankings Across Entire Season<a class="anchor-link" href="#Tracking-Team-Rankings-Across-Entire-Season">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Going back to our workflow diagram, we need to calculate and store Team Rankings at the end of each day during the season. Once we have this list for each team, we can calculate the longest streak at a single position.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># get list of days</span>
<span class="n">rank_history</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">all_dates</span> <span class="o">=</span> <span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="c1"># calculate ranks after each day there is a game</span>
<span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">all_dates</span><span class="p">:</span>
    <span class="c1"># get results up to current day</span>
    <span class="n">dailyresults_byteam</span> <span class="o">=</span> <span class="p">(</span><span class="n">team_results</span><span class="p">[</span><span class="n">team_results</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">day</span><span class="p">]</span>
                               <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Team&#39;</span><span class="p">]))</span>
    
    <span class="c1"># create league table with ranking</span>
    <span class="c1"># premier league ranking goes: Points, GD, GF</span>
    <span class="n">league_table</span> <span class="o">=</span> <span class="p">(</span><span class="n">dailyresults_byteam</span>
                        <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">standings</span><span class="p">,</span>
                               <span class="n">result_col</span><span class="o">=</span><span class="s1">&#39;Result&#39;</span><span class="p">,</span>
                               <span class="n">goals_col</span><span class="o">=</span><span class="s1">&#39;Goals&#39;</span><span class="p">,</span>
                               <span class="n">goals_opp_col</span><span class="o">=</span><span class="s1">&#39;Goals_Opp&#39;</span><span class="p">,</span>
                               <span class="n">points_col</span><span class="o">=</span><span class="s1">&#39;Points&#39;</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Points&#39;</span><span class="p">,</span> <span class="s1">&#39;GD&#39;</span><span class="p">,</span> <span class="s1">&#39;GF&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">team_rank</span> <span class="o">=</span> <span class="n">rank_teams</span><span class="p">(</span><span class="n">league_table</span><span class="p">,</span> <span class="n">team_list</span><span class="o">=</span><span class="n">all_teams</span><span class="p">)</span>
    
    <span class="n">rank_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">team_rank</span><span class="p">)</span>
    
<span class="c1"># create historical ranking dataframe from list of ranks</span>
<span class="n">rank_history_df</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
                    <span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">rank_history</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">all_dates</span><span class="p">))</span>

<span class="c1"># Reindex and include all dates</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">rank_history_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">end</span><span class="o">=</span><span class="n">rank_history_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">rank_history_df</span> <span class="o">=</span> <span class="n">rank_history_df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rank_history_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[21]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Arsenal</th>
      <th>Bournemouth</th>
      <th>Burnley</th>
      <th>Chelsea</th>
      <th>Crystal Palace</th>
      <th>Everton</th>
      <th>Hull</th>
      <th>Leicester</th>
      <th>Liverpool</th>
      <th>Man City</th>
      <th>Man United</th>
      <th>Middlesbrough</th>
      <th>Southampton</th>
      <th>Stoke</th>
      <th>Sunderland</th>
      <th>Swansea</th>
      <th>Tottenham</th>
      <th>Watford</th>
      <th>West Brom</th>
      <th>West Ham</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-08-13</th>
      <td>15</td>
      <td>15</td>
      <td>13</td>
      <td>15</td>
      <td>13</td>
      <td>5</td>
      <td>1</td>
      <td>11</td>
      <td>15</td>
      <td>1</td>
      <td>15</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>11</td>
      <td>3</td>
      <td>5</td>
      <td>5</td>
      <td>3</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2016-08-14</th>
      <td>13</td>
      <td>18</td>
      <td>16</td>
      <td>19</td>
      <td>16</td>
      <td>7</td>
      <td>3</td>
      <td>14</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>14</td>
      <td>5</td>
      <td>7</td>
      <td>7</td>
      <td>5</td>
      <td>19</td>
    </tr>
    <tr>
      <th>2016-08-15</th>
      <td>14</td>
      <td>20</td>
      <td>18</td>
      <td>3</td>
      <td>18</td>
      <td>8</td>
      <td>3</td>
      <td>15</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>15</td>
      <td>6</td>
      <td>8</td>
      <td>8</td>
      <td>6</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2016-08-16</th>
      <td>14</td>
      <td>20</td>
      <td>18</td>
      <td>3</td>
      <td>18</td>
      <td>8</td>
      <td>3</td>
      <td>15</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>15</td>
      <td>6</td>
      <td>8</td>
      <td>8</td>
      <td>6</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2016-08-17</th>
      <td>14</td>
      <td>20</td>
      <td>18</td>
      <td>3</td>
      <td>18</td>
      <td>8</td>
      <td>3</td>
      <td>15</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>15</td>
      <td>6</td>
      <td>8</td>
      <td>8</td>
      <td>6</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rank_history_df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[22]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Arsenal</th>
      <th>Bournemouth</th>
      <th>Burnley</th>
      <th>Chelsea</th>
      <th>Crystal Palace</th>
      <th>Everton</th>
      <th>Hull</th>
      <th>Leicester</th>
      <th>Liverpool</th>
      <th>Man City</th>
      <th>Man United</th>
      <th>Middlesbrough</th>
      <th>Southampton</th>
      <th>Stoke</th>
      <th>Sunderland</th>
      <th>Swansea</th>
      <th>Tottenham</th>
      <th>Watford</th>
      <th>West Brom</th>
      <th>West Ham</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-04-06</th>
      <td>5</td>
      <td>13</td>
      <td>14</td>
      <td>1</td>
      <td>16</td>
      <td>7</td>
      <td>17</td>
      <td>11</td>
      <td>3</td>
      <td>4</td>
      <td>6</td>
      <td>19</td>
      <td>9</td>
      <td>12</td>
      <td>20</td>
      <td>18</td>
      <td>2</td>
      <td>10</td>
      <td>8</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2017-04-07</th>
      <td>5</td>
      <td>13</td>
      <td>14</td>
      <td>1</td>
      <td>16</td>
      <td>7</td>
      <td>17</td>
      <td>11</td>
      <td>3</td>
      <td>4</td>
      <td>6</td>
      <td>19</td>
      <td>9</td>
      <td>12</td>
      <td>20</td>
      <td>18</td>
      <td>2</td>
      <td>10</td>
      <td>8</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2017-04-08</th>
      <td>5</td>
      <td>15</td>
      <td>12</td>
      <td>1</td>
      <td>16</td>
      <td>7</td>
      <td>17</td>
      <td>11</td>
      <td>3</td>
      <td>4</td>
      <td>6</td>
      <td>19</td>
      <td>9</td>
      <td>13</td>
      <td>20</td>
      <td>18</td>
      <td>2</td>
      <td>10</td>
      <td>8</td>
      <td>14</td>
    </tr>
    <tr>
      <th>2017-04-09</th>
      <td>6</td>
      <td>15</td>
      <td>12</td>
      <td>1</td>
      <td>16</td>
      <td>7</td>
      <td>17</td>
      <td>11</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>19</td>
      <td>9</td>
      <td>13</td>
      <td>20</td>
      <td>18</td>
      <td>2</td>
      <td>10</td>
      <td>8</td>
      <td>14</td>
    </tr>
    <tr>
      <th>2017-04-10</th>
      <td>6</td>
      <td>15</td>
      <td>12</td>
      <td>1</td>
      <td>16</td>
      <td>7</td>
      <td>17</td>
      <td>11</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>19</td>
      <td>9</td>
      <td>13</td>
      <td>20</td>
      <td>18</td>
      <td>2</td>
      <td>10</td>
      <td>8</td>
      <td>14</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have Team Rankings across the entire season, we can adapt <a href="http://stackoverflow.com/questions/14358567/finding-consecutive-segments-in-a-pandas-data-frame">code found on StackOverflow</a> <em>(Praise Be)</em> to find consecutive segments in the <code>rank_history_df</code> DataFrame.</p>
<p>We will also use a <a href="http://stackoverflow.com/questions/9647202/ordinal-numbers-replacement">lambda formula found on StackOverflow</a> <em>(Praise Be)</em> to output the ordinal suffix for each position (i.e. 6=6th. 3=3rd).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ordinal</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%d%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="s2">&quot;tsnrhtdd&quot;</span><span class="p">[(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">%</span><span class="k">10</span>!=1)*(n%10&lt;4)*n%10::4])

<span class="c1"># for each team in the league, get the length of the longest streak</span>
<span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">all_teams</span><span class="p">:</span>
    <span class="n">rank_history_team</span> <span class="o">=</span> <span class="n">rank_history_df</span><span class="p">[</span><span class="n">team</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
    <span class="n">rank_history_team</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
    <span class="n">rank_history_team</span><span class="p">[</span><span class="s1">&#39;block&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">rank_history_team</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">rank_history_team</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
                                      <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
                                      <span class="o">.</span><span class="n">cumsum</span><span class="p">())</span>

    <span class="n">streak_lengths</span> <span class="o">=</span> <span class="p">(</span><span class="n">rank_history_team</span>
                          <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
                          <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;block&#39;</span><span class="p">])[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
                          <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
    
    <span class="n">pos</span> <span class="o">=</span> <span class="n">streak_lengths</span><span class="o">.</span><span class="n">argmax</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">max_length</span> <span class="o">=</span> <span class="n">streak_lengths</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{team}</span><span class="s1"> was {ordinal(pos)} for </span><span class="si">{max_length}</span><span class="s1"> days&#39;</span><span class="p">)</span>  <span class="c1"># f-string! =)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Arsenal was 4th for 27 days
Bournemouth was 14th for 46 days
Burnley was 14th for 28 days
Chelsea was 1st for 121 days
Crystal Palace was 17th for 35 days
Everton was 7th for 82 days
Hull was 18th for 42 days
Leicester was 15th for 33 days
Liverpool was 4th for 27 days
Man City was 1st for 55 days
Man United was 6th for 104 days
Middlesbrough was 16th for 31 days
Southampton was 10th for 31 days
Stoke was 9th for 31 days
Sunderland was 20th for 69 days
Swansea was 19th for 35 days
Tottenham was 5th for 63 days
Watford was 14th for 28 days
West Brom was 8th for 101 days
West Ham was 18th for 27 days
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We know that <a href="http://www.thescore.com/epl/news/1257969-manchester-united-s-104-day-residency-in-6th-place-over">Manchester United held 6th for 104 days</a>. This matches the output of our program so we know our function is working!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Calculating-Longest-Streaks-For-Each-Season">Calculating Longest Streaks For Each Season<a class="anchor-link" href="#Calculating-Longest-Streaks-For-Each-Season">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To complete our task, we will need to run the above workflow across all seasons available on <a href="http://www.football-data.co.uk/englandm.php">football-data.co.uk match results</a>.</p>
<p>I wrote a script to download and analyze each season's data to find teams which have held static in the league table. After the script is run, it prints a list of teams with streaks &gt;=104 days.</p>
<p>The code is a bit messy, but it gets the job done. We can download <a href="https://github.com/alysivji/blog-notebooks/blob/master/premier-league-holding-steady-league-table/longest_streak.py">the script from Github</a> and run it as follows:</p>
<div class="highlight"><pre><span></span><span class="gp">$</span> python longest_streak.py

<span class="go">9394</span>
<span class="go">Blackburn was 2nd for 131 days</span>
<span class="go">Man United was 1st for 259 days</span>
<span class="go">Swindon was 22nd for 260 days</span>

<span class="go">9495</span>

<span class="go">9596</span>
<span class="go">Bolton was 20th for 105 days</span>
<span class="go">Newcastle was 1st for 174 days</span>

<span class="go">9697</span>

<span class="go">9798</span>
<span class="go">Man United was 1st for 175 days</span>

<span class="go">9899</span>
<span class="go">Nott&#39;m Forest was 20th for 149 days</span>

<span class="go">9900</span>
<span class="go">Man United was 1st for 107 days</span>
<span class="go">Sheffield Weds was 20th for 154 days</span>
<span class="go">Watford was 20th for 114 days</span>

<span class="go">0001</span>
<span class="go">Arsenal was 2nd for 110 days</span>
<span class="go">Bradford was 20th for 155 days</span>
<span class="go">Man United was 1st for 218 days</span>

<span class="go">0102</span>
<span class="go">Derby was 19th for 120 days</span>
<span class="go">Leicester was 20th for 137 days</span>

<span class="go">0203</span>
<span class="go">Arsenal was 1st for 126 days</span>

<span class="go">0304</span>
<span class="go">Arsenal was 1st for 105 days</span>

<span class="go">0405</span>
<span class="go">Chelsea was 1st for 191 days</span>
<span class="go">Everton was 4th for 139 days</span>

<span class="go">0506</span>
<span class="go">Chelsea was 1st for 257 days</span>
<span class="go">Sunderland was 20th for 191 days</span>
<span class="go">Tottenham was 4th for 155 days</span>

<span class="go">0607</span>
<span class="go">Chelsea was 2nd for 204 days</span>
<span class="go">Man United was 1st for 204 days</span>

<span class="go">0708</span>
<span class="go">Chelsea was 3rd for 111 days</span>
<span class="go">Derby was 20th for 197 days</span>
<span class="go">Fulham was 19th for 126 days</span>
<span class="go">Tottenham was 11th for 114 days</span>

<span class="go">0809</span>
<span class="go">Everton was 6th for 128 days</span>
<span class="go">West Brom was 20th for 127 days</span>

<span class="go">0910</span>
<span class="go">Portsmouth was 20th for 244 days</span>

<span class="go">1011</span>
<span class="go">Chelsea was 1st for 105 days</span>
<span class="go">Man United was 1st for 127 days</span>

<span class="go">1112</span>
<span class="go">Man City was 1st for 119 days</span>
<span class="go">Man United was 2nd for 119 days</span>

<span class="go">1213</span>
<span class="go">Man City was 2nd for 177 days</span>
<span class="go">Man United was 1st for 177 days</span>

<span class="go">1314</span>

<span class="go">1415</span>
<span class="go">Chelsea was 1st for 268 days</span>
<span class="go">Leicester was 20th for 140 days</span>

<span class="go">1516</span>
<span class="go">Aston Villa was 20th for 206 days</span>
<span class="go">Leicester was 1st for 116 days</span>

<span class="go">1617</span>
<span class="go">Man United was 6th for 104 days</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Ahem.</strong> Don't let Manchester United's 104 days in 6th place distract you from the fact that Everton were 6th for 128 days in the 2008-09 Premier League season.</p>
<h4 id="Note">Note<a class="anchor-link" href="#Note">&#182;</a></h4><ul>
<li>From the above output, we can see how competitive each PL season was on a high level. This might be a good topic for further study.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this post, we took a Premier League results dataset and transformed it into a pandas <code>DataFrame</code>. We also created functions to make it easy to generate a standing table along with a list of each team's rank.</p>
<p>Finally, we ran historical Premier League matchup results through the above functions to find the longest stretch of time where a team held the same position in the league table for an extended period of time.</p>

</div>
</div>
</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

  </div>

<div class="article-tag-list">
<span class="label label-default">Tags</span>
	<a href="./tag/python.html"><i class="fa fa-tag"></i>python</a>&nbsp;
	<a href="./tag/pandas.html"><i class="fa fa-tag"></i>pandas</a>&nbsp;
	<a href="./tag/data-science.html"><i class="fa fa-tag"></i>data-science</a>&nbsp;
</div>  <hr />
  <div class="well well-sm">  <!-- Social media sharing buttons -->
    <!-- Twitter -->
    <a href="https://twitter.com/share" class="twitter-share-button" 
       data-via="CaiusSivjus" >Tweet</a>&nbsp;

    <!-- Google+ -->
    <div class="g-plus" data-action="share" data-annotation="bubble"></div>
    &nbsp;&nbsp;&nbsp;&nbsp;
    <div class="g-plusone" data-size="medium"></div>&nbsp;

    <!-- Facebook -->
    <div class="fb-like" 
        data-href="./pl-analysis-part1-finding-longest-consecutive-position-streak.html" 
        data-layout="button_count" 
        data-action="like" data-show-faces="true" 
        data-share="true">
    </div>
    &nbsp;
  </div> <!-- /Social media sharing buttons -->
  <div class="comments">
	<h2>Comments</h2>
	<div id="disqus_thread"></div>
	<script type="text/javascript">
				   (function() {
						var dsq = document.createElement('script');
						dsq.type = 'text/javascript'; dsq.async = true;
						dsq.src = '//siv-scripts.disqus.com/embed.js';
						(document.getElementsByTagName('head')[0] ||
						 document.getElementsByTagName('body')[0]).appendChild(dsq);
				  })();
	</script>
  </div>
</article>
        </div><!-- /content -->

        <div class="col-md-3 sidebar-nav" id="sidebar">

<div class="row">

<div class="col-xs-6 col-md-12">
<h4><i class="fa fa-comment fa-fw fa-lg"></i> Social</h4>
<ul class="list-unstyled social-links">
    <li><a href="http://linkedin.com/in/alysivji/" target="_blank">
	  <i class="fa fa-linkedin-square fa-fw fa-lg" title="LinkedIn"></i>
		LinkedIn
	</a></li>
    <li><a href="http://github.com/alysivji" target="_blank">
	  <i class="fa fa-github-square fa-fw fa-lg" title="GitHub"></i>
		GitHub
	</a></li>
    <li><a href="https://twitter.com/CaiusSivjus" target="_blank">
	  <i class="fa fa-twitter-square fa-fw fa-lg" title="Twitter"></i>
		Twitter
	</a></li>
</ul>
</div>

<div class="col-xs-6 col-md-12">
<h4><i class="fa fa-folder fa-fw fa-lg"></i> Categories</h4>
<ul class="list-unstyled category-links">
  <li><a href="./category/data-analysis.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Data Analysis</a></li>
  <li><a href="./category/deep-dives.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Deep Dives</a></li>
  <li><a href="./category/quick-hits.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Quick Hits</a></li>
  <li><a href="./category/thoughts.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Thoughts</a></li>
  <li><a href="./category/tutorials.html" >
    <i class="fa fa-folder-open fa-fw fa-lg"></i> Tutorials</a></li>
</ul>
</div>

</div> <!-- /row -->

<h4><i class="fa fa-tags fa-fw fa-lg"></i> Tags</h4>
<p class="tag-cloud">
    <span class="tag-2">
      <a href="./tag/data-viz.html">
          <i class="fa fa-tag"></i>
        data-viz
      </a>
    </span>
    <span class="tag-1">
      <a href="./tag/python.html">
          <i class="fa fa-tag"></i>
        python
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/reddit-scraper.html">
          <i class="fa fa-tag"></i>
        reddit-scraper
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/pythonic.html">
          <i class="fa fa-tag"></i>
        pythonic
      </a>
    </span>
    <span class="tag-3">
      <a href="./tag/flask.html">
          <i class="fa fa-tag"></i>
        flask
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/data-science.html">
          <i class="fa fa-tag"></i>
        data-science
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/workflow.html">
          <i class="fa fa-tag"></i>
        workflow
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/exploring-pypi.html">
          <i class="fa fa-tag"></i>
        exploring-pypi
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/mongodb.html">
          <i class="fa fa-tag"></i>
        mongodb
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/math.html">
          <i class="fa fa-tag"></i>
        math
      </a>
    </span>
    <span class="tag-3">
      <a href="./tag/book.html">
          <i class="fa fa-tag"></i>
        book
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/pandas.html">
          <i class="fa fa-tag"></i>
        pandas
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/cest-la-vie.html">
          <i class="fa fa-tag"></i>
        c'est-la-vie
      </a>
    </span>
    <span class="tag-3">
      <a href="./tag/software-engineering.html">
          <i class="fa fa-tag"></i>
        software-engineering
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/vim.html">
          <i class="fa fa-tag"></i>
        vim
      </a>
    </span>
    <span class="tag-3">
      <a href="./tag/grad-school.html">
          <i class="fa fa-tag"></i>
        grad-school
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/docker.html">
          <i class="fa fa-tag"></i>
        docker
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/php.html">
          <i class="fa fa-tag"></i>
        php
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/terminal.html">
          <i class="fa fa-tag"></i>
        terminal
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/productivity.html">
          <i class="fa fa-tag"></i>
        productivity
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/review.html">
          <i class="fa fa-tag"></i>
        review
      </a>
    </span>
    <span class="tag-2">
      <a href="./tag/testing.html">
          <i class="fa fa-tag"></i>
        testing
      </a>
    </span>
    <span class="tag-1">
      <a href="./tag/how-to.html">
          <i class="fa fa-tag"></i>
        how-to
      </a>
    </span>
    <span class="tag-3">
      <a href="./tag/web-scraping.html">
          <i class="fa fa-tag"></i>
        web-scraping
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/web-development.html">
          <i class="fa fa-tag"></i>
        web-development
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/gis.html">
          <i class="fa fa-tag"></i>
        gis
      </a>
    </span>
    <span class="tag-4">
      <a href="./tag/elasticsearch.html">
          <i class="fa fa-tag"></i>
        elasticsearch
      </a>
    </span>
</p>
<h4><i class="fa fa-rss fa-fw fa-lg"></i> Feeds</h4>
<ul class="list-unstyled">
    <li><a href="http://alysivji.github.io/feeds/all.atom.xml" 
		   type="application/atom+xml" rel="alternate">
		<i class="fa fa-rss-square fa-fw fa-lg"></i> Atom Feed</a></li>
</ul>

<hr />

        </div><!--/sidebar -->
      </div><!--/row-->
    </div><!--/.container /#main-container -->

    <footer id="site-footer">
      <address id="site-colophon">
        <p class="text-center text-muted">
        Site built using <a href="http://getpelican.com/" target="_blank">Pelican</a>
        &nbsp;&bull;&nbsp; Theme based on
        <a href="http://www.voidynullness.net/page/voidy-bootstrap-pelican-theme/"
           target="_blank">VoidyBootstrap</a> by
        <a href="http://www.robertiwancz.com/"
           target="_blank">RKI</a>
        </p>
      </address><!-- /colophon  -->
    </footer>

<!-- DISQUS script for displaying comment count -->
<script type="text/javascript">
    var disqus_shortname = 'siv-scripts';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

    <!-- javascript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>


<!-- Facebook -->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script>

<!-- Twitter -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Google+ -->
<!-- Synchronous 
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
-->
<!-- Asynchronous -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/platform.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>  </body>
</html>